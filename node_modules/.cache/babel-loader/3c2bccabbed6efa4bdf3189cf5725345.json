{"remainingRequest":"C:\\wamp64\\www\\crm\\frontend\\node_modules\\thread-loader\\dist\\cjs.js!C:\\wamp64\\www\\crm\\frontend\\node_modules\\babel-loader\\lib\\index.js!C:\\wamp64\\www\\crm\\frontend\\node_modules\\eslint-loader\\index.js??ref--14-0!C:\\wamp64\\www\\crm\\frontend\\src\\state\\modules\\auth.js","dependencies":[{"path":"C:\\wamp64\\www\\crm\\frontend\\src\\state\\modules\\auth.js","mtime":1646480346000},{"path":"C:\\wamp64\\www\\crm\\frontend\\babel.config.js","mtime":1645939880000},{"path":"C:\\wamp64\\www\\crm\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1668443304858},{"path":"C:\\wamp64\\www\\crm\\frontend\\node_modules\\thread-loader\\dist\\cjs.js","mtime":1668443304941},{"path":"C:\\wamp64\\www\\crm\\frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":1652458135842},{"path":"C:\\wamp64\\www\\crm\\frontend\\node_modules\\eslint-loader\\index.js","mtime":1668443311682}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmpzb24uc3RyaW5naWZ5LmpzIjsKaW1wb3J0IHsgZ2V0RmlyZWJhc2VCYWNrZW5kIH0gZnJvbSAnLi4vLi4vYXV0aFV0aWxzLmpzJzsKZXhwb3J0IHZhciBzdGF0ZSA9IHsKICBjdXJyZW50VXNlcjogc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSgnYXV0aFVzZXInKQp9OwpleHBvcnQgdmFyIG11dGF0aW9ucyA9IHsKICBTRVRfQ1VSUkVOVF9VU0VSOiBmdW5jdGlvbiBTRVRfQ1VSUkVOVF9VU0VSKHN0YXRlLCBuZXdWYWx1ZSkgewogICAgc3RhdGUuY3VycmVudFVzZXIgPSBuZXdWYWx1ZTsKICAgIHNhdmVTdGF0ZSgnYXV0aC5jdXJyZW50VXNlcicsIG5ld1ZhbHVlKTsKICB9Cn07CmV4cG9ydCB2YXIgZ2V0dGVycyA9IHsKICAvLyBXaGV0aGVyIHRoZSB1c2VyIGlzIGN1cnJlbnRseSBsb2dnZWQgaW4uCiAgbG9nZ2VkSW46IGZ1bmN0aW9uIGxvZ2dlZEluKHN0YXRlKSB7CiAgICByZXR1cm4gISFzdGF0ZS5jdXJyZW50VXNlcjsKICB9Cn07CmV4cG9ydCB2YXIgYWN0aW9ucyA9IHsKICAvLyBUaGlzIGlzIGF1dG9tYXRpY2FsbHkgcnVuIGluIGBzcmMvc3RhdGUvc3RvcmUuanNgIHdoZW4gdGhlIGFwcAogIC8vIHN0YXJ0cywgYWxvbmcgd2l0aCBhbnkgb3RoZXIgYWN0aW9ucyBuYW1lZCBgaW5pdGAgaW4gb3RoZXIgbW9kdWxlcy4KICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdW51c2VkLXZhcnMKICBpbml0OiBmdW5jdGlvbiBpbml0KF9yZWYpIHsKICAgIHZhciBzdGF0ZSA9IF9yZWYuc3RhdGUsCiAgICAgICAgZGlzcGF0Y2ggPSBfcmVmLmRpc3BhdGNoOwogICAgZGlzcGF0Y2goJ3ZhbGlkYXRlJyk7CiAgfSwKICAvLyBMb2dzIGluIHRoZSBjdXJyZW50IHVzZXIuCiAgbG9nSW46IGZ1bmN0aW9uIGxvZ0luKF9yZWYyKSB7CiAgICB2YXIgY29tbWl0ID0gX3JlZjIuY29tbWl0LAogICAgICAgIGRpc3BhdGNoID0gX3JlZjIuZGlzcGF0Y2gsCiAgICAgICAgZ2V0dGVycyA9IF9yZWYyLmdldHRlcnM7CgogICAgdmFyIF9yZWYzID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiB7fSwKICAgICAgICBlbWFpbCA9IF9yZWYzLmVtYWlsLAogICAgICAgIHBhc3N3b3JkID0gX3JlZjMucGFzc3dvcmQ7CgogICAgaWYgKGdldHRlcnMubG9nZ2VkSW4pIHJldHVybiBkaXNwYXRjaCgndmFsaWRhdGUnKTsKICAgIHJldHVybiBnZXRGaXJlYmFzZUJhY2tlbmQoKS5sb2dpblVzZXIoZW1haWwsIHBhc3N3b3JkKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICB2YXIgdXNlciA9IHJlc3BvbnNlOwogICAgICBjb21taXQoJ1NFVF9DVVJSRU5UX1VTRVInLCB1c2VyKTsKICAgICAgcmV0dXJuIHVzZXI7CiAgICB9KTsKICB9LAogIC8vIExvZ3Mgb3V0IHRoZSBjdXJyZW50IHVzZXIuCiAgbG9nT3V0OiBmdW5jdGlvbiBsb2dPdXQoX3JlZjQpIHsKICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgdmFyIGNvbW1pdCA9IF9yZWY0LmNvbW1pdDsKICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby11bnVzZWQtdmFycwogICAgY29tbWl0KCdTRVRfQ1VSUkVOVF9VU0VSJywgbnVsbCk7CiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdW51c2VkLXZhcnMKICAgICAgZ2V0RmlyZWJhc2VCYWNrZW5kKCkubG9nb3V0KCkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICByZXNvbHZlKHRydWUpOwogICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgICByZWplY3QoX3RoaXMuX2hhbmRsZUVycm9yKGVycm9yKSk7CiAgICAgIH0pOwogICAgfSk7CiAgfSwKICAvLyByZWdpc3RlciB0aGUgdXNlcgogIHJlZ2lzdGVyOiBmdW5jdGlvbiByZWdpc3RlcihfcmVmNSkgewogICAgdmFyIGNvbW1pdCA9IF9yZWY1LmNvbW1pdCwKICAgICAgICBkaXNwYXRjaCA9IF9yZWY1LmRpc3BhdGNoLAogICAgICAgIGdldHRlcnMgPSBfcmVmNS5nZXR0ZXJzOwoKICAgIHZhciBfcmVmNiA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDoge30sCiAgICAgICAgdXNlcm5hbWUgPSBfcmVmNi51c2VybmFtZSwKICAgICAgICBlbWFpbCA9IF9yZWY2LmVtYWlsLAogICAgICAgIHBhc3N3b3JkID0gX3JlZjYucGFzc3dvcmQ7CgogICAgaWYgKGdldHRlcnMubG9nZ2VkSW4pIHJldHVybiBkaXNwYXRjaCgndmFsaWRhdGUnKTsKICAgIHJldHVybiBnZXRGaXJlYmFzZUJhY2tlbmQoKS5yZWdpc3RlclVzZXIodXNlcm5hbWUsIGVtYWlsLCBwYXNzd29yZCkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgdmFyIHVzZXIgPSByZXNwb25zZTsKICAgICAgY29tbWl0KCdTRVRfQ1VSUkVOVF9VU0VSJywgdXNlcik7CiAgICAgIHJldHVybiB1c2VyOwogICAgfSk7CiAgfSwKICAvLyByZWdpc3RlciB0aGUgdXNlcgogIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby11bnVzZWQtdmFycwogIHJlc2V0UGFzc3dvcmQ6IGZ1bmN0aW9uIHJlc2V0UGFzc3dvcmQoX3JlZjcpIHsKICAgIHZhciBjb21taXQgPSBfcmVmNy5jb21taXQsCiAgICAgICAgZGlzcGF0Y2ggPSBfcmVmNy5kaXNwYXRjaCwKICAgICAgICBnZXR0ZXJzID0gX3JlZjcuZ2V0dGVyczsKCiAgICB2YXIgX3JlZjggPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IHt9LAogICAgICAgIGVtYWlsID0gX3JlZjguZW1haWw7CgogICAgaWYgKGdldHRlcnMubG9nZ2VkSW4pIHJldHVybiBkaXNwYXRjaCgndmFsaWRhdGUnKTsKICAgIHJldHVybiBnZXRGaXJlYmFzZUJhY2tlbmQoKS5mb3JnZXRQYXNzd29yZChlbWFpbCkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgdmFyIG1lc3NhZ2UgPSByZXNwb25zZS5kYXRhOwogICAgICByZXR1cm4gbWVzc2FnZTsKICAgIH0pOwogIH0sCiAgLy8gVmFsaWRhdGVzIHRoZSBjdXJyZW50IHVzZXIncyB0b2tlbiBhbmQgcmVmcmVzaGVzIGl0CiAgLy8gd2l0aCBuZXcgZGF0YSBmcm9tIHRoZSBBUEkuCiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXVudXNlZC12YXJzCiAgdmFsaWRhdGU6IGZ1bmN0aW9uIHZhbGlkYXRlKF9yZWY5KSB7CiAgICB2YXIgY29tbWl0ID0gX3JlZjkuY29tbWl0LAogICAgICAgIHN0YXRlID0gX3JlZjkuc3RhdGU7CiAgICBpZiAoIXN0YXRlLmN1cnJlbnRVc2VyKSByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKG51bGwpOwogICAgdmFyIHVzZXIgPSBnZXRGaXJlYmFzZUJhY2tlbmQoKS5nZXRBdXRoZW50aWNhdGVkVXNlcigpOwogICAgY29tbWl0KCdTRVRfQ1VSUkVOVF9VU0VSJywgdXNlcik7CiAgICByZXR1cm4gdXNlcjsKICB9Cn07IC8vID09PQovLyBQcml2YXRlIGhlbHBlcnMKLy8gPT09CgpmdW5jdGlvbiBzYXZlU3RhdGUoa2V5LCBzdGF0ZSkgewogIHdpbmRvdy5zZXNzaW9uU3RvcmFnZS5zZXRJdGVtKGtleSwgSlNPTi5zdHJpbmdpZnkoc3RhdGUpKTsKfQ=="},{"version":3,"sources":["C:/wamp64/www/crm/frontend/src/state/modules/auth.js"],"names":["getFirebaseBackend","state","currentUser","sessionStorage","getItem","mutations","SET_CURRENT_USER","newValue","saveState","getters","loggedIn","actions","init","dispatch","logIn","commit","email","password","loginUser","then","response","user","logOut","Promise","resolve","reject","logout","catch","error","_handleError","register","username","registerUser","resetPassword","forgetPassword","message","data","validate","getAuthenticatedUser","key","window","setItem","JSON","stringify"],"mappings":"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","sourcesContent":["import { getFirebaseBackend } from '../../authUtils.js'\r\n\r\nexport const state = {\r\n    currentUser: sessionStorage.getItem('authUser'),\r\n}\r\n\r\nexport const mutations = {\r\n    SET_CURRENT_USER(state, newValue) {\r\n        state.currentUser = newValue\r\n        saveState('auth.currentUser', newValue)\r\n    }\r\n}\r\n\r\nexport const getters = {\r\n    // Whether the user is currently logged in.\r\n    loggedIn(state) {\r\n        return !!state.currentUser\r\n    }\r\n}\r\n\r\nexport const actions = {\r\n    // This is automatically run in `src/state/store.js` when the app\r\n    // starts, along with any other actions named `init` in other modules.\r\n    // eslint-disable-next-line no-unused-vars\r\n    init({ state, dispatch }) {\r\n        dispatch('validate')\r\n    },\r\n\r\n    // Logs in the current user.\r\n    logIn({ commit, dispatch, getters }, { email, password } = {}) {\r\n        if (getters.loggedIn) return dispatch('validate')\r\n\r\n        return getFirebaseBackend().loginUser(email, password).then((response) => {\r\n            const user = response\r\n            commit('SET_CURRENT_USER', user)\r\n            return user\r\n        });\r\n    },\r\n\r\n    // Logs out the current user.\r\n    logOut({ commit }) {\r\n        // eslint-disable-next-line no-unused-vars\r\n        commit('SET_CURRENT_USER', null)\r\n        return new Promise((resolve, reject) => {\r\n            // eslint-disable-next-line no-unused-vars\r\n            getFirebaseBackend().logout().then((response) => {\r\n                resolve(true);\r\n            }).catch((error) => {\r\n                reject(this._handleError(error));\r\n            })\r\n        });\r\n    },\r\n\r\n    // register the user\r\n    register({ commit, dispatch, getters }, { username, email, password } = {}) {\r\n        if (getters.loggedIn) return dispatch('validate')\r\n\r\n        return getFirebaseBackend().registerUser(username, email, password).then((response) => {\r\n            const user = response\r\n            commit('SET_CURRENT_USER', user)\r\n            return user\r\n        });\r\n    },\r\n\r\n    // register the user\r\n    // eslint-disable-next-line no-unused-vars\r\n    resetPassword({ commit, dispatch, getters }, { email } = {}) {\r\n        if (getters.loggedIn) return dispatch('validate')\r\n\r\n        return getFirebaseBackend().forgetPassword(email).then((response) => {\r\n            const message = response.data\r\n            return message\r\n        });\r\n    },\r\n\r\n    // Validates the current user's token and refreshes it\r\n    // with new data from the API.\r\n    // eslint-disable-next-line no-unused-vars\r\n    validate({ commit, state }) {\r\n        if (!state.currentUser) return Promise.resolve(null)\r\n        const user = getFirebaseBackend().getAuthenticatedUser();\r\n        commit('SET_CURRENT_USER', user)\r\n        return user;\r\n    },\r\n}\r\n\r\n// ===\r\n// Private helpers\r\n// ===\r\n\r\nfunction saveState(key, state) {\r\n    window.sessionStorage.setItem(key, JSON.stringify(state))\r\n}\r\n"]}]}