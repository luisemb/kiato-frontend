{"remainingRequest":"C:\\wamp64\\www\\crm\\frontend\\node_modules\\babel-loader\\lib\\index.js!C:\\wamp64\\www\\crm\\frontend\\node_modules\\eslint-loader\\index.js??ref--14-0!C:\\wamp64\\www\\crm\\frontend\\src\\functions\\plivoClients.js","dependencies":[{"path":"C:\\wamp64\\www\\crm\\frontend\\src\\functions\\plivoClients.js","mtime":1677778738984},{"path":"C:\\wamp64\\www\\crm\\frontend\\babel.config.js","mtime":1645939880000},{"path":"C:\\wamp64\\www\\crm\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1668443304858},{"path":"C:\\wamp64\\www\\crm\\frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":1652458135842},{"path":"C:\\wamp64\\www\\crm\\frontend\\node_modules\\eslint-loader\\index.js","mtime":1668443311682}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:cmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLm1hcC5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmcuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuaXRlcmF0b3IuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLml0ZXJhdG9yLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLmV4ZWMuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuc3BsaXQuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcubWF0Y2guanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAudG8tc3RyaW5nLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuanNvbi5zdHJpbmdpZnkuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5jb25jYXQuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAudGVzdC5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuZm9yLWVhY2guanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcucmVwbGFjZS5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LnVpbnQ4LWFycmF5LmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuYXQuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5jb3B5LXdpdGhpbi5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LmV2ZXJ5LmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuZmlsbC5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LmZpbHRlci5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LmZpbmQuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5maW5kLWluZGV4LmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuZm9yLWVhY2guanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5pbmNsdWRlcy5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LmluZGV4LW9mLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuaXRlcmF0b3IuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5qb2luLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkubGFzdC1pbmRleC1vZi5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5Lm1hcC5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LnJlZHVjZS5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LnJlZHVjZS1yaWdodC5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LnJldmVyc2UuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5zZXQuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5zbGljZS5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LnNvbWUuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5zb3J0LmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuc3ViYXJyYXkuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS50by1sb2NhbGUtc3RyaW5nLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkudG8tc3RyaW5nLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuc2xpY2UuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5udW1iZXIuY29uc3RydWN0b3IuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcudHJpbS5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZpbmQuanMiKTsKCnZhciBhdWRpb0NodW5rcywKICAgIHJlYywKICAgIGF1ZGlvU3RyZWFtQ29udGV4dCwKICAgIHVpb3B0aW9ucywKICAgIGxvY2FsU3RvcmFnZSA9IHdpbmRvdy5sb2NhbFN0b3JhZ2U7CnZhciBjYWxsU3RvcmFnZSA9IHt9LAogICAgdGltZXIgPSAiMDA6MDA6MDAiOwp2YXIgaW5jb21pbmdOb3RpZmljYXRpb25zID0gbmV3IE1hcCgpOwp2YXIgc3BlYWtlclNvdXJjZU5vZGU7CnZhciByaW5ndG9uZVNvdXJjZU5vZGU7CnZhciBpbmNvbWluZ05vdGlmaWNhdGlvbkFsZXJ0ID0gbnVsbDsKdmFyIGRlZmF1bHRTZXR0aW5ncyA9IHsKICAiZGVidWciOiAiSU5GTyIsCiAgInBlcm1PbkNsaWNrIjogZmFsc2UsCiAgImNvZGVjcyI6IFsiT1BVUyIsICJQQ01VIl0sCiAgImVuYWJsZUlQVjYiOiBmYWxzZSwKICAiYXVkaW9Db25zdHJhaW50cyI6IHsKICAgICJvcHRpb25hbCI6IFt7CiAgICAgICJnb29nQXV0b0dhaW5Db250cm9sIjogZmFsc2UKICAgIH1dCiAgfSwKICAiZHNjcCI6IHRydWUsCiAgImVuYWJsZVRyYWNraW5nIjogdHJ1ZSwKICAiY2xvc2VQcm90ZWN0aW9uIjogZmFsc2UsCiAgIm1heEF2ZXJhZ2VCaXRyYXRlIjogNDgwMDAsCiAgImFsbG93TXVsdGlwbGVJbmNvbWluZ0NhbGxzIjogZmFsc2UsCiAgImR0bWZPcHRpb25zIjogewogICAgc2VuZER0bWZUeXBlOiBbIm91dGJhbmQiLCAiaW5iYW5kIl0KICB9Cn07CnZhciBpdGk7CnZhciBpbmNvbWluZ0NhbGxJbmZvOwp2YXIgaXNJbmNvbWluZ0NhbGxQcmVzZW50ID0gZmFsc2U7CnZhciBvdXRwdXRWb2x1bWVCYXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnb3V0cHV0LXZvbHVtZScpOwp2YXIgaW5wdXRWb2x1bWVCYXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaW5wdXQtdm9sdW1lJyk7CgpTdHJpbmcucHJvdG90eXBlLmNhbGx0aW1lciA9IGZ1bmN0aW9uICgpIHsKICB2YXIgc2VjX251bSA9IHBhcnNlSW50KHRoaXMsIDEwKTsKICB2YXIgaG91cnMgPSBNYXRoLmZsb29yKHNlY19udW0gLyAzNjAwKTsKICB2YXIgbWludXRlcyA9IE1hdGguZmxvb3IoKHNlY19udW0gLSBob3VycyAqIDM2MDApIC8gNjApOwogIHZhciBzZWNvbmRzID0gc2VjX251bSAtIGhvdXJzICogMzYwMCAtIG1pbnV0ZXMgKiA2MDsKCiAgaWYgKGhvdXJzIDwgMTApIHsKICAgIGhvdXJzID0gIjAiICsgaG91cnM7CiAgfQoKICBpZiAobWludXRlcyA8IDEwKSB7CiAgICBtaW51dGVzID0gIjAiICsgbWludXRlczsKICB9CgogIGlmIChzZWNvbmRzIDwgMTApIHsKICAgIHNlY29uZHMgPSAiMCIgKyBzZWNvbmRzOwogIH0KCiAgcmV0dXJuIGhvdXJzICsgJzonICsgbWludXRlcyArICc6JyArIHNlY29uZHM7Cn07IC8vIGNyb3NzIGJyb3dzZXIgZm9yZWFjaCBzdXBwb3J0CgoKdmFyIF9mb3JFYWNoID0gZnVuY3Rpb24gX2ZvckVhY2goY2IpIHsKICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubGVuZ3RoOyBpKyspIHsKICAgIGNiKHRoaXNbaV0pOwogIH0KfTsgLy8gVUkgdHdlYWtzCgoKJCgnI21ha2VjYWxsJykuYXR0cignY2xhc3MnLCAnYnRuIGJ0bi1zdWNjZXNzIGJ0bi1ibG9jayBmbGF0YnRuIG1ha2VjYWxsIGRpc2FibGVkJyk7CgpmdW5jdGlvbiBkYXRlKCkgewogIHJldHVybiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkuc3Vic3RyaW5nKDAsIDEwKSArICIgIiArIERhdGUoKS5zcGxpdCgiICIpWzRdOwp9CgpmdW5jdGlvbiBraWNrU3RhcnROb3coKSB7CiAgJCgnLmxvYWRlcicpLnNob3coKTsKICAkKCcuZmFkZWluLWVmZmVjdCcpLmZhZGVJbig1MDAwKTsKfQoKZnVuY3Rpb24gbG9naW4odXNlcm5hbWUsIHBhc3N3b3JkKSB7CiAgaWYgKHVzZXJuYW1lICYmIHBhc3N3b3JkKSB7CiAgICAvL3N0YXJ0IFVJIGxvYWQgc3Bpbm5lcgogICAga2lja1N0YXJ0Tm93KCk7CiAgICBwbGl2b0Jyb3dzZXJTZGsuY2xpZW50LmxvZ2luKHVzZXJuYW1lLCBwYXNzd29yZCk7CiAgfSBlbHNlIHsKICAgIGNvbnNvbGUuZXJyb3IoJ3VzZXJuYW1lL3Bhc3N3b3JkIG1pc3NpbmchJyk7CiAgfQp9CgpmdW5jdGlvbiBhdWRpb0RldmljZUNoYW5nZShlKSB7CiAgY29uc29sZS5sb2coJ2F1ZGlvRGV2aWNlQ2hhbmdlJywgZSk7CgogIGlmIChlLmNoYW5nZSkgewogICAgaWYgKGUuY2hhbmdlID09ICJhZGRlZCIpIHsKICAgICAgY3VzdG9tQWxlcnQoZS5jaGFuZ2UsIGUuZGV2aWNlLmtpbmQgKyAiIC0gIiArIGUuZGV2aWNlLmxhYmVsLCAnaW5mbycpOwogICAgfSBlbHNlIHsKICAgICAgY3VzdG9tQWxlcnQoZS5jaGFuZ2UsIGUuZGV2aWNlLmtpbmQgKyAiIC0gIiArIGUuZGV2aWNlLmxhYmVsLCAnd2FybicpOwogICAgfQogIH0gZWxzZSB7CiAgICBjdXN0b21BbGVydCgnaW5mbycsICdUaGVyZSBpcyBhbiBhdWRpb0RldmljZUNoYW5nZSBidXQgbWVkaWFQZXJtaXNzaW9uIGlzIG5vdCBhbGxvd2VkIHlldCcpOwogIH0KfQoKZnVuY3Rpb24gb25QZXJtaXNzaW9uRGVuaWVkKGNhdXNlLCBjYWxsaW5mbykgewogIGNvbnNvbGUubG9nKCdvblBlcm1pc3Npb25EZW5pZWQ6ICcsIGNhdXNlKTsKICBjdXN0b21BbGVydChjYXVzZSwgJ3dhcm4nKTsKfQoKZnVuY3Rpb24gb25Db25uZWN0aW9uQ2hhbmdlKG9iaikgewogIGNvbnNvbGUubG9nKCdvbkNvbm5lY3Rpb25DaGFuZ2U6ICcsIG9iaik7CgogIGlmIChvYmouc3RhdGUgPT09ICJjb25uZWN0ZWQiKSB7CiAgICBjb25zb2xlLmxvZyhvYmouc3RhdGUsICJpbmZvIiwgJ2luZm8nKTsKICB9IGVsc2UgaWYgKG9iai5zdGF0ZSA9PT0gImRpc2Nvbm5lY3RlZCIpIHsKICAgIGlmIChvYmouZXZlbnRDb2RlICYmIG9iai5ldmVudFJlYXNvbikgewogICAgICBjdXN0b21BbGVydChvYmouc3RhdGUgKyAiICIgKyBvYmouZXZlbnRDb2RlICsgIiAiICsgb2JqLmV2ZW50UmVhc29uLCAiaW5mbyIpOwogICAgfSBlbHNlIGlmIChvYmouZXZlbnRDb2RlICYmICFvYmouZXZlbnRSZWFzb24pIHsKICAgICAgY3VzdG9tQWxlcnQob2JqLnN0YXRlICsgIiAiICsgb2JqLmV2ZW50Q29kZSwgImluZm8iKTsKICAgIH0gZWxzZSBpZiAoIW9iai5ldmVudENvZGUgJiYgb2JqLmV2ZW50UmVhc29uKSB7CiAgICAgIGN1c3RvbUFsZXJ0KG9iai5zdGF0ZSArICIgIiArIG9iai5ldmVudFJlYXNvbiwgImluZm8iKTsKICAgIH0gZWxzZSB7CiAgICAgIGN1c3RvbUFsZXJ0KG9iai5zdGF0ZSwgImluZm8iKTsKICAgIH0KICB9IGVsc2UgewogICAgY29uc29sZS5sb2coInVua25vd24gY29ubmVjdGlvbiBzdGF0ZSAiKTsKICB9Cn0KCmZ1bmN0aW9uIG9uV2VicnRjTm90U3VwcG9ydGVkKCkgewogIGNvbnNvbGUud2Fybignbm8gd2ViUlRDIHN1cHBvcnQnKTsKICBhbGVydCgnV2VicnRjIGlzIG5vdCBzdXBwb3J0ZWQgaW4gdGhpcyBicm9zd2VyLCBQbGVhc2UgdXNlIGxhdGVzdCB2ZXJzaW9uIG9mIGNocm9tZS9maXJlZm94L29wZXJhL0lFIEVkZ2UnKTsKfQoKZnVuY3Rpb24gbWVkaWFNZXRyaWNzKG9iaikgewogIC8qKg0KICAgKiBTZXQgYSB0cmlnZ2VyIGZvciBRdWFsaXR5IEZCIHBvcHVwIHdoZW4gdGhlcmUgaXMgYW4gd2FybmluZyBkcnVpbmcgY2FsbCB1c2luZyBzZXNzaW9uU3RvcmFnZQ0KICAgKiBEdXJpbmcgYG9uQ2FsbFRlcm1pbmF0ZWRgIGV2ZW50IGNoZWNrIGZvciBgdHJpZ2dlckZCYCBmbGFnDQogICAqLwogIHNlc3Npb25TdG9yYWdlLnNldEl0ZW0oJ3RyaWdnZXJGQicsIHRydWUpOwogIGNvbnNvbGUudGFibGUoW29ial0pOwogIHZhciBjbGFzc0V4aXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLi0nICsgb2JqLnR5cGUpOwogIHZhciBtZXNzYWdlID0gb2JqLnR5cGU7CiAgLyoqDQogICAqIElmIHRoZXJlIGlzIGEgc2FtZSBhdWRpbyBsZXZlbCBmb3IgMyBzYW1wbGVzIHRoZW4gd2Ugd2lsbCBnZXQgYSB0cmlnZ2VyDQogICAqIElmIGF1ZGlvIGxldmVsIGlzIGdyZWF0ZXIgdGhhbiAzMCB0aGVuIGl0IGNvdWxkIGJlIHNvbWUgY29udGludW91cyBlY2hvIG9yIHVzZXIgaXMgbm90IHNwZWFraW5nDQogICAqIFNldCBtZXNzYWdlICJzYW1lIGxldmVsIiBmb3IgYXVkaW8gZ3JlYXRlciB0aGFuIDMwLiBMZXNzIHRoYW4gMzAgY291bGQgYmUgYSBwb3NzaWJsZSBtdXRlDQogICAqLwoKICBpZiAob2JqLnR5cGUubWF0Y2goJ2F1ZGlvJykgJiYgb2JqLnZhbHVlID4gMSkgewogICAgbWVzc2FnZSA9ICJzYW1lIGxldmVsIjsKICB9CgogIGlmIChvYmouYWN0aXZlKSB7CiAgICBjbGFzc0V4aXN0ID8gY2xhc3NFeGlzdC5yZW1vdmUoKSA6IG51bGw7CiAgICB2YXIgY2xvc2VBbGVydCA9IE1hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnN1YnN0cmluZyg3KTsKICAgICQoIi5vbmNhbGxhbGVydG1zZyIpLmFwcGVuZCgnPGRpdiBpZD0iYWxlcnQnICsgY2xvc2VBbGVydCArICciIGNsYXNzPSJtZXRyaWNzIC0nICsgb2JqLnR5cGUgKyAnIj4nICsgJzxzcGFuPicgKyBvYmoubGV2ZWwgKyAnIHwgPC9zcGFuPicgKyAnPHNwYW4+JyArIG1lc3NhZ2UgKyAnIDogJyArIG9iai52YWx1ZSArICcgfCA8L3NwYW4+PHNwYW4gPicgKyBvYmouZGVzYyArICc8L3NwYW4+JyArICc8c3BhbiBhcmlhLWhpZGRlbj0idHJ1ZSIgb25jbGljaz0iY2xvc2VNZXRyaWNzKHRoaXMpIiBzdHlsZT0ibWFyZ2luLWxlZnQ6MTVweDtjdXJzb3I6cG9pbnRlcjsiPlg8L3NwYW4+JyArICc8L2Rpdj4nKTsKICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAkKCcjJyArICdhbGVydCcgKyBjbG9zZUFsZXJ0KS5yZW1vdmUoKTsKICAgIH0sIDUwMDApOwogIH0KCiAgaWYgKCFvYmouYWN0aXZlICYmIGNsYXNzRXhpc3QpIHsKICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy4tJyArIG9iai50eXBlKS5yZW1vdmUoKTsKICB9IC8vIEhhbmRsZSBubyBtaWMgaW5wdXQgZXZlbiBhZnRlciBtaWMgYWNjZXNzCgoKICBpZiAob2JqLmRlc2MgPT0gIm5vIGFjY2VzcyB0byB5b3VyIG1pY3JvcGhvbmUiKSB7CiAgICAkKCcjbWljQWNjZXNzQmxvY2snKS5tb2RhbCh7CiAgICAgIHNob3c6IHRydWUKICAgIH0pOwogIH0KfQoKZnVuY3Rpb24gb25SZWFkeSgpIHsKICAkKCcjcGhvbmVzdGF0dXMnKS5odG1sKCd0cnlpbmcgdG8gbG9naW4uLi4nKTsKICBjb25zb2xlLmluZm8oJ1JlYWR5Jyk7Cn0KCmZ1bmN0aW9uIG9uTG9naW4oKSB7CiAgJCgnI2xvZ2luQ29udGFpbmVyJykuaGlkZSgpOwogICQoJyNjYWxsQ29udGFpbmVyJykuc2hvdygpOwogIGRvY3VtZW50LmJvZHkuc3R5bGUuYmFja2dyb3VuZEltYWdlID0gJ25vbmUnOwogIHZhciB1c2VybmFtZSA9IHBsaXZvQnJvd3NlclNkay5jbGllbnQudXNlck5hbWU7CiAgJCgnI3NpcFVzZXJOYW1lJykuaHRtbCh1c2VybmFtZSArICdAJyArIHBsaXZvQnJvd3NlclNkay5jbGllbnQucGhvbmUuY29uZmlndXJhdGlvbi5ob3N0cG9ydF9wYXJhbXMpOwogIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ3RpdGxlJykuaW5uZXJIVE1MID0gdXNlcm5hbWU7CiAgJCgnI3Bob25lc3RhdHVzJykuaHRtbCgnb25saW5lJyk7CiAgY29uc29sZS5pbmZvKCdMb2dnZWQgaW4nKTsKICB2YXIgY3VzdG9tQ2FsbGVySWQgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnY2FsbGVySWQnKTsKCiAgaWYgKGN1c3RvbUNhbGxlcklkKSB7CiAgICB2YXIgY2FsbGVyaWQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiY2FsbGVyaWQiKTsKICAgIGNhbGxlcmlkLnZhbHVlID0gY3VzdG9tQ2FsbGVySWQ7CiAgfQoKICAkKCcjbWFrZWNhbGwnKS5hdHRyKCdjbGFzcycsICdidG4gYnRuLXN1Y2Nlc3MgYnRuLWJsb2NrIGZsYXRidG4gbWFrZWNhbGwnKTsKICBjdXN0b21BbGVydCgiY29ubmVjdGVkIiwgImluZm8iLCAnaW5mbycpOwogICQoJy5sb2FkZXInKS5oaWRlKCk7Cn0KCmZ1bmN0aW9uIG9uTG9naW5GYWlsZWQocmVhc29uKSB7CiAgY29uc29sZS5pbmZvKCdvbkxvZ2luRmFpbGVkICcsIHJlYXNvbik7CgogIGlmIChPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwocmVhc29uKSA9PSAiW29iamVjdCBPYmplY3RdIikgewogICAgcmVhc29uID0gSlNPTi5zdHJpbmdpZnkocmVhc29uKTsKICB9CgogIGN1c3RvbUFsZXJ0KCdMb2dpbiBmYWlsdXJlIDonLCByZWFzb24sICd3YXJuJyk7CiAgJCgnLmxvYWRlcicpLmhpZGUoKTsKfQoKZnVuY3Rpb24gcGVyZm9ybUxvZ291dCgpIHsKICBkb2N1bWVudC5ib2R5LnN0eWxlLmJhY2tncm91bmRJbWFnZSA9ICd1cmwoaW1nL2JhY2tncm91bmQuc3ZnKSc7CiAgJCgnI2xvZ2luQ29udGFpbmVyJykuc2hvdygpOwogICQoJyNjYWxsQ29udGFpbmVyJykuaGlkZSgpOwogICQoJy5sb2FkZXInKS5oaWRlKCk7CiAgJCgnI3RvTnVtYmVyJykudmFsKCIiKTsKICBpdGkuc2V0Q291bnRyeSgidXMiKTsKICBsb2NhbFN0b3JhZ2UuY2xlYXIoKTsKfQoKZnVuY3Rpb24gb25Mb2dvdXQoKSB7CiAgY29uc29sZS5pbmZvKCdvbkxvZ291dCcpOwogIHBlcmZvcm1Mb2dvdXQoKTsKfQoKZnVuY3Rpb24gb25DYWxsaW5nKCkgewogICQoJyNjYWxsc3RhdHVzJykuaHRtbCgnUHJvZ3Jlc3MuLi4nKTsKICBjb25zb2xlLmluZm8oJ29uQ2FsbGluZycpOwp9CgpmdW5jdGlvbiBvbkNhbGxSZW1vdGVSaW5naW5nKGNhbGxJbmZvKSB7CiAgaWYgKGNhbGxJbmZvKSBjb25zb2xlLmxvZyhKU09OLnN0cmluZ2lmeShjYWxsSW5mbykpOwogICQoJyNjYWxsc3RhdHVzJykuaHRtbCgnUmluZ2luZy4uLicpOwogIGNvbnNvbGUuaW5mbygnb25DYWxsUmVtb3RlUmluZ2luZycpOwp9CgpmdW5jdGlvbiBvbk1lZGlhQ29ubmVjdGVkKGNhbGxJbmZvKSB7CiAgaWYgKGNhbGxJbmZvKSBjb25zb2xlLmxvZyhKU09OLnN0cmluZ2lmeShjYWxsSW5mbykpOwoKICBpZiAoY2FsbEluZm8gJiYgY2FsbEluZm8uZGlyZWN0aW9uID09PSAnaW5jb21pbmcnKSB7CiAgICAkKCcjY2FsbHN0YXR1cycpLmh0bWwoJ0Fuc3dlcmVkJyk7CiAgfQoKICBjb25zb2xlLmluZm8oJ29uTWVkaWFDb25uZWN0ZWQnKTsKfQoKZnVuY3Rpb24gb25DYWxsQW5zd2VyZWQoY2FsbEluZm8pIHsKICBjb25zb2xlLmluZm8oJ29uQ2FsbEFuc3dlcmVkJyk7CiAgaWYgKGNhbGxJbmZvKSBjb25zb2xlLmluZm8oSlNPTi5zdHJpbmdpZnkoY2FsbEluZm8pKTsKICAkKCcjY2FsbHN0YXR1cycpLmh0bWwoJ0Fuc3dlcmVkJyk7CiAgJCgnLmhhbmd1cCcpLnNob3coKTsKCiAgaWYgKGNhbGxJbmZvICYmIGNhbGxJbmZvLmRpcmVjdGlvbiA9PT0gJ2luY29taW5nJykgewogICAgJCgnI3Bob25lJykuaGlkZSgpOwogICAgJCgnI2JvdW5kVHlwZScpLmh0bWwoJ0luY29taW5nIDogJyArIGNhbGxJbmZvLnNyYyk7CiAgICAkKCcjY2FsbE51bScpLmh0bWwoY2FsbEluZm8uc3JjKTsKICAgICQoJyNjYWxsRHVyYXRpb24nKS5odG1sKCcwMDowMDowMCcpOwogICAgJCgnLmNhbGxpbmZvJykuc2hvdygpOwoKICAgIGlmIChpbmNvbWluZ05vdGlmaWNhdGlvbnMuaGFzKGNhbGxJbmZvLmNhbGxVVUlEKSkgewogICAgICB2YXIgaW5jb21pbmdDYWxsID0gaW5jb21pbmdOb3RpZmljYXRpb25zLmdldChjYWxsSW5mby5jYWxsVVVJRCk7CiAgICAgIGlmIChpbmNvbWluZ0NhbGwpIGluY29taW5nQ2FsbC5oaWRlKCk7CiAgICAgIGluY29taW5nTm90aWZpY2F0aW9ucy5kZWxldGUoY2FsbEluZm8uY2FsbFVVSUQpOwogICAgfQogIH0KCiAgdGltZXIgPSAwOwogIGlmICh3aW5kb3cuY2FsbHRpbWVyKSBjbGVhckludGVydmFsKHdpbmRvdy5jYWxsdGltZXIpOwogIHdpbmRvdy5jYWxsdGltZXIgPSBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7CiAgICB0aW1lciA9IHRpbWVyICsgMTsKICAgICQoJyNjYWxsRHVyYXRpb24nKS5odG1sKHRpbWVyLnRvU3RyaW5nKCkuY2FsbHRpbWVyKCkpOwogIH0sIDEwMDApOwp9CgpmdW5jdGlvbiBvbkNhbGxUZXJtaW5hdGVkKGV2dCwgY2FsbEluZm8pIHsKICAkKCcjY2FsbHN0YXR1cycpLmh0bWwoJ0NhbGwgRW5kZWQnKTsKICBjb25zb2xlLmluZm8oIm9uQ2FsbFRlcm1pbmF0ZWQgIi5jb25jYXQoZXZ0KSk7CiAgY2xlYXJTdGFycygpOwogICQoJyNzZW5kUXVhbGl0eUZlZWRiYWNrJykubW9kYWwoJ3Nob3cnKTsKCiAgaWYgKGNhbGxJbmZvICYmIGNhbGxJbmZvLmNhbGxVVUlEID09PSBwbGl2b0Jyb3dzZXJTZGsuY2xpZW50LmdldENhbGxVVUlEKCkpIHsKICAgIGNvbnNvbGUuaW5mbyhKU09OLnN0cmluZ2lmeShjYWxsSW5mbykpOwogICAgY2FsbE9mZihldnQpOwogIH0gZWxzZSBpZiAoIWNhbGxJbmZvKSB7CiAgICBjYWxsT2ZmKGV2dCk7CiAgfQp9CgpmdW5jdGlvbiBvbkNhbGxGYWlsZWQocmVhc29uLCBjYWxsSW5mbykgewogIGlmIChjYWxsSW5mbykgewogICAgY29uc29sZS5sb2coSlNPTi5zdHJpbmdpZnkoY2FsbEluZm8pKTsKICAgIGNvbnNvbGUuaW5mbygib25DYWxsRmFpbGVkICIuY29uY2F0KHJlYXNvbiwgIiAiKS5jb25jYXQoY2FsbEluZm8uY2FsbFVVSUQsICIgIikuY29uY2F0KGNhbGxJbmZvLmRpcmVjdGlvbikpOwogIH0gZWxzZSB7CiAgICBjb25zb2xlLmluZm8oIm9uQ2FsbEZhaWxlZCAiLmNvbmNhdChyZWFzb24pKTsKICB9CgogIGlmIChyZWFzb24gJiYgL0RlbmllZCBNZWRpYS9pLnRlc3QocmVhc29uKSkgewogICAgJCgnI2NhbGxzdGF0dXMnKS5odG1sKCdjYWxsIGZhaWxlZCcpOwogICAgJCgnI21lZGlhQWNjZXNzQmxvY2snKS5tb2RhbCgnc2hvdycpOwogIH0KCiAgOwoKICBpZiAoIWNhbGxJbmZvKSB7CiAgICBjYWxsT2ZmKHJlYXNvbik7CiAgICByZXR1cm47CiAgfQoKICBpZiAoaW5jb21pbmdOb3RpZmljYXRpb25zLmhhcyhjYWxsSW5mby5jYWxsVVVJRCkpIHsKICAgIHZhciBpbmNvbWluZ0NhbGwgPSBpbmNvbWluZ05vdGlmaWNhdGlvbnMuZ2V0KGNhbGxJbmZvLmNhbGxVVUlEKTsKCiAgICBpZiAoaW5jb21pbmdDYWxsKSB7CiAgICAgIGluY29taW5nQ2FsbC5oaWRlKCk7CiAgICB9CgogICAgaW5jb21pbmdOb3RpZmljYXRpb25zLmRlbGV0ZShjYWxsSW5mby5jYWxsVVVJRCk7CiAgfQoKICBpZiAoaW5jb21pbmdOb3RpZmljYXRpb25zLnNpemUgPT09IDAgJiYgIXBsaXZvQnJvd3NlclNkay5jbGllbnQuZ2V0Q2FsbFVVSUQoKSkgewogICAgY2FsbE9mZihyZWFzb24pOwogIH0gZWxzZSBpZiAoaW5jb21pbmdOb3RpZmljYXRpb25zLnNpemUgPT09IDAgJiYgY2FsbEluZm8uZGlyZWN0aW9uID09PSAnb3V0Z29pbmcnKSB7CiAgICBjYWxsT2ZmKHJlYXNvbik7CiAgfQp9CgpmdW5jdGlvbiBvbk1lZGlhUGVybWlzc2lvbihldnQpIHsKICBjb25zb2xlLmluZm8oJ29uTWVkaWFQZXJtaXNzaW9uJywgZXZ0KTsKCiAgaWYgKGV2dC5lcnJvcikgewogICAgY3VzdG9tQWxlcnQoJ01lZGlhIHBlcm1pc3Npb24gZXJyb3InLCBldnQuZXJyb3IsICd3YXJuJyk7CiAgICBpZiAoY2xpZW50LmJyb3dzZXJEZXRhaWxzLmJyb3dzZXIgPT0gImNocm9tZSIpICQoJyNtZWRpYUFjY2Vzc0Jsb2NrJykubW9kYWwoJ3Nob3cnKTsKICB9Cn0KCmZ1bmN0aW9uIG9uSW5jb21pbmdDYWxsKGNhbGxlck5hbWUsIGV4dHJhSGVhZGVycywgY2FsbEluZm8sIGNhbGxlcl9OYW1lKSB7CiAgY29uc29sZS5pbmZvKCdvbkluY29taW5nQ2FsbCA6ICcsIGNhbGxlck5hbWUsIGV4dHJhSGVhZGVycywgY2FsbEluZm8sIGNhbGxlcl9OYW1lKTsKICB2YXIgcHJldkluY29taW5nID0gaXNJbmNvbWluZ0NhbGxQcmVzZW50OwogIGlzSW5jb21pbmdDYWxsUHJlc2VudCA9IHRydWU7CiAgY2FsbFN0b3JhZ2Uuc3RhcnRUaW1lID0gZGF0ZSgpOwogIGNhbGxTdG9yYWdlLm1vZGUgPSAnaW4nOwogIGNhbGxTdG9yYWdlLm51bSA9IGNhbGxlcl9OYW1lOwoKICBpZiAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NhbGxzdGF0dXMnKS5pbm5lckhUTUwgPT0gJ0lkbGUnICYmICFwcmV2SW5jb21pbmcpIHsKICAgICQoJyNpbmNvbWluZ0NhbGxEZWZhdWx0Jykuc2hvdygpOwogICAgJCgnI3Bob25lJykuaGlkZSgpOwogICAgJCgnI2NhbGxzdGF0dXMnKS5odG1sKCdSaW5naW5nLi4uJyk7CiAgICAkKCcjY2FsbGVybnVtJykuaHRtbChjYWxsZXJfTmFtZSk7CiAgICBpbmNvbWluZ0NhbGxJbmZvID0gY2FsbEluZm87CgogICAgaWYgKGNhbGxJbmZvKSB7CiAgICAgIGluY29taW5nTm90aWZpY2F0aW9ucy5zZXQoY2FsbEluZm8uY2FsbFVVSUQsIG51bGwpOwogICAgfQogIH0gZWxzZSB7CiAgICAkKCcjY2FsbHN0YXR1cycpLmh0bWwoJ1JpbmdpbmcuLi4nKTsKICAgIHZhciBpbmNvbWluZ05vdGlmaWNhdGlvbiA9IE5vdGlmeS5zdWNjZXNzKCJJbmNvbWluZyBDYWxsOiAiLmNvbmNhdChjYWxsZXJfTmFtZSkpLmJ1dHRvbignQW5zd2VyJywgZnVuY3Rpb24gKCkgewogICAgICBpc0luY29taW5nQ2FsbFByZXNlbnQgPSBmYWxzZTsKICAgICAgY29uc29sZS5pbmZvKCdDYWxsIGFjY2VwdCBjbGlja2VkJyk7CgogICAgICBpZiAoY2FsbEluZm8pIHsKICAgICAgICBwbGl2b0Jyb3dzZXJTZGsuY2xpZW50LmFuc3dlcihjYWxsSW5mby5jYWxsVVVJRCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcGxpdm9Ccm93c2VyU2RrLmNsaWVudC5hbnN3ZXIoKTsKICAgICAgfQogICAgfSkuYnV0dG9uKCdSZWplY3QnLCBmdW5jdGlvbiAoKSB7CiAgICAgIGlzSW5jb21pbmdDYWxsUHJlc2VudCA9IGZhbHNlOwogICAgICBjb25zb2xlLmluZm8oJ2NhbGxSZWplY3QnKTsKCiAgICAgIGlmIChjYWxsSW5mbykgewogICAgICAgIHBsaXZvQnJvd3NlclNkay5jbGllbnQucmVqZWN0KGNhbGxJbmZvLmNhbGxVVUlEKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBwbGl2b0Jyb3dzZXJTZGsuY2xpZW50LnJlamVjdCgpOwogICAgICB9CiAgICB9KS5idXR0b24oJ0lnbm9yZScsIGZ1bmN0aW9uICgpIHsKICAgICAgaXNJbmNvbWluZ0NhbGxQcmVzZW50ID0gZmFsc2U7CiAgICAgIGNvbnNvbGUuaW5mbygnY2FsbCBJZ25vcmVkJyk7CgogICAgICBpZiAoY2FsbEluZm8pIHsKICAgICAgICBwbGl2b0Jyb3dzZXJTZGsuY2xpZW50Lmlnbm9yZShjYWxsSW5mby5jYWxsVVVJRCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcGxpdm9Ccm93c2VyU2RrLmNsaWVudC5pZ25vcmUoKTsKICAgICAgfQogICAgfSk7CgogICAgaWYgKGNhbGxJbmZvKSB7CiAgICAgIGNvbnNvbGUuaW5mbyhKU09OLnN0cmluZ2lmeShjYWxsSW5mbykpOwogICAgICBpbmNvbWluZ05vdGlmaWNhdGlvbnMuc2V0KGNhbGxJbmZvLmNhbGxVVUlELCBpbmNvbWluZ05vdGlmaWNhdGlvbik7CiAgICB9IGVsc2UgewogICAgICBpbmNvbWluZ05vdGlmaWNhdGlvbkFsZXJ0ID0gaW5jb21pbmdOb3RpZmljYXRpb247CiAgICB9CiAgfQp9CgpmdW5jdGlvbiBvbkluY29taW5nQ2FsbENhbmNlbGVkKGNhbGxJbmZvKSB7CiAgaWYgKGNhbGxJbmZvKSBjb25zb2xlLmluZm8oSlNPTi5zdHJpbmdpZnkoY2FsbEluZm8pKTsKICB2YXIgaW5jb21pbmdDYWxsTm90aWZpY2F0aW9uOwoKICBpZiAoY2FsbEluZm8pIHsKICAgIGluY29taW5nQ2FsbE5vdGlmaWNhdGlvbiA9IGluY29taW5nTm90aWZpY2F0aW9ucy5nZXQoY2FsbEluZm8uY2FsbFVVSUQpOwogICAgaW5jb21pbmdOb3RpZmljYXRpb25zLmRlbGV0ZShjYWxsSW5mby5jYWxsVVVJRCk7CiAgfSBlbHNlIGlmIChpbmNvbWluZ05vdGlmaWNhdGlvbkFsZXJ0KSB7CiAgICBpbmNvbWluZ0NhbGxOb3RpZmljYXRpb24gPSBpbmNvbWluZ05vdGlmaWNhdGlvbkFsZXJ0OwogIH0KCiAgaWYgKGluY29taW5nQ2FsbE5vdGlmaWNhdGlvbikgewogICAgaW5jb21pbmdDYWxsTm90aWZpY2F0aW9uLmhpZGUoKTsKICB9CgogIGlmIChpbmNvbWluZ05vdGlmaWNhdGlvbnMuc2l6ZSA9PT0gMCAmJiAhcGxpdm9Ccm93c2VyU2RrLmNsaWVudC5nZXRDYWxsVVVJRCgpKSB7CiAgICBjYWxsT2ZmKCk7CiAgfQp9CgpmdW5jdGlvbiBjYWxsT2ZmKHJlYXNvbikgewogICQoJy5jYWxsaW5mbycpLmhpZGUoKTsKICAkKCcuaW5jb21pbmdDYWxsRGVmYXVsdCcpLmhpZGUoKTsKICBzaG93S2V5cGFkSW5mbygpOwogIHJlc2V0TXV0ZSgpOwogIHdpbmRvdy5jYWxsdGltZXIgPyBjbGVhckludGVydmFsKHdpbmRvdy5jYWxsdGltZXIpIDogZmFsc2U7CiAgY2FsbFN0b3JhZ2UuZHVyID0gdGltZXIudG9TdHJpbmcoKS5jYWxsdGltZXIoKTsKCiAgaWYgKHRpbWVyID09ICIwMDowMDowMCIgJiYgY2FsbFN0b3JhZ2UubW9kZSA9PSAiaW4iKSB7CiAgICBjYWxsU3RvcmFnZS5tb2RlID0gIm1pc3NlZCI7CiAgfQoKICAkKCcjY2FsbHN0YXR1cycpLmh0bWwoJ0lkbGUnKTsKICBjYWxsU3RvcmFnZSA9IHt9OyAvLyByZXNldCBjYWxsU3RvcmFnZQoKICB0aW1lciA9ICIwMDowMDowMCI7IC8vcmVzZXQgdGhlIHRpbWVyCn0KCmZ1bmN0aW9uIGNsb3NlTWV0cmljcyhlKSB7CiAgZS5wYXJlbnRFbGVtZW50LnJlbW92ZSgpOwp9CgpmdW5jdGlvbiByZXNldFNldHRpbmdzKCkgewogIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2dsZXZlbGJ0bicpLnZhbHVlID0gIklORk8iOwogIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdvbnBhZ2Vsb2FkJykuY2hlY2tlZCA9IHRydWU7CiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21vbml0b3JxdWFsaXR5JykuY2hlY2tlZCA9IHRydWU7CiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RvbnRjbG9zZXByb3RlY3QnKS5jaGVja2VkID0gdHJ1ZTsKICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYWxsb3dkc2NwJykuY2hlY2tlZCA9IHRydWU7CiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25vaW5jb21pbmcnKS5jaGVja2VkID0gdHJ1ZTsKICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbXNyZWdpb25idG4nKS52YWx1ZSA9ICJBVVRPIjsKICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYXZlcmFnZWJpdHJhdGUnKS52YWx1ZSA9IDQ4MDAwOwogIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdwbGl2b3NldHRpbmdzJywgSlNPTi5zdHJpbmdpZnkoZGVmYXVsdFNldHRpbmdzKSk7Cn0KCmZ1bmN0aW9uIHJlZnJlc2hTZXR0aW5ncygpIHsKICB2YXIgZ2V0U2V0dGluZ3MgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgncGxpdm9zZXR0aW5ncycpOwoKICBpZiAoZ2V0U2V0dGluZ3MpIHsKICAgIHZhciBwYXJzZWRTZXR0aW5ncyA9IEpTT04ucGFyc2UoZ2V0U2V0dGluZ3MpOwogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvZ2xldmVsYnRuJykudmFsdWUgPSBwYXJzZWRTZXR0aW5ncy5kZWJ1ZzsKICAgIHVwZGF0ZUVsZW1lbnRzSW5Db25maWcocGFyc2VkU2V0dGluZ3MucGVybU9uQ2xpY2ssICdvbmNhbGxpbml0JywgJ29ucGFnZWxvYWQnKTsKICAgIHVwZGF0ZUVsZW1lbnRzSW5Db25maWcocGFyc2VkU2V0dGluZ3MuZW5hYmxlVHJhY2tpbmcsICdtb25pdG9ycXVhbGl0eScsICdkb250bW9uaXRvcnF1YWxpdHknKTsKICAgIHVwZGF0ZUVsZW1lbnRzSW5Db25maWcocGFyc2VkU2V0dGluZ3MuY2xvc2VQcm90ZWN0aW9uLCAnY2xvc2Vwcm90ZWN0JywgJ2RvbnRjbG9zZXByb3RlY3QnKTsKICAgIHVwZGF0ZUVsZW1lbnRzSW5Db25maWcocGFyc2VkU2V0dGluZ3MuZHNjcCwgJ2FsbG93ZHNjcCcsICdub2RzY3AnKTsKICAgIHVwZGF0ZUVsZW1lbnRzSW5Db25maWcocGFyc2VkU2V0dGluZ3MuYWxsb3dNdWx0aXBsZUluY29taW5nQ2FsbHMsICdhbGxvd2luY29taW5nJywgJ25vaW5jb21pbmcnKTsKCiAgICBpZiAocGFyc2VkU2V0dGluZ3MuY2xpZW50UmVnaW9uID09IG51bGwpIHsKICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21zcmVnaW9uYnRuJykudmFsdWUgPSAnQVVUTyc7CiAgICB9IGVsc2UgewogICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbXNyZWdpb25idG4nKS52YWx1ZSA9IHBhcnNlZFNldHRpbmdzLmNsaWVudFJlZ2lvbjsKICAgIH0KCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYXZlcmFnZWJpdHJhdGUnKS52YWx1ZSA9IHBhcnNlZFNldHRpbmdzLm1heEF2ZXJhZ2VCaXRyYXRlOwogICAgdWlvcHRpb25zID0gcGFyc2VkU2V0dGluZ3M7CiAgICByZXR1cm4gcGFyc2VkU2V0dGluZ3M7CiAgfSBlbHNlIHsKICAgIHVpb3B0aW9ucyA9IGRlZmF1bHRTZXR0aW5nczsKICAgIHJldHVybiBkZWZhdWx0U2V0dGluZ3M7CiAgfQp9CgpmdW5jdGlvbiB1cGRhdGVTZXR0aW5ncyh2YWwpIHsKICB2YXIgbG9nbGV2ZWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9nbGV2ZWxidG4nKS52YWx1ZTsKICB2YWwuZGVidWcgPSBsb2dsZXZlbDsKICBjaGFuZ2VWYWwodmFsLCBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnb25wYWdlbG9hZCcpLmNoZWNrZWQsICdwZXJtT25DbGljaycsIHRydWUpOwogIGNoYW5nZVZhbCh2YWwsIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtb25pdG9ycXVhbGl0eScpLmNoZWNrZWQsICJlbmFibGVUcmFja2luZyIsIGZhbHNlKTsKICBjaGFuZ2VWYWwodmFsLCBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZG9udGNsb3NlcHJvdGVjdCcpLmNoZWNrZWQsICJjbG9zZVByb3RlY3Rpb24iLCB0cnVlKTsKICBjaGFuZ2VWYWwodmFsLCBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYWxsb3dkc2NwJykuY2hlY2tlZCwgImRzY3AiLCBmYWxzZSk7CiAgY2hhbmdlVmFsKHZhbCwgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25vaW5jb21pbmcnKS5jaGVja2VkLCAiYWxsb3dNdWx0aXBsZUluY29taW5nQ2FsbHMiLCB0cnVlKTsKICB2YXIgY2xpZW50UmVnaW9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21zcmVnaW9uYnRuJykudmFsdWU7CgogIGlmIChjbGllbnRSZWdpb24gIT0gJ0FVVE8nKSB7CiAgICB2YWwuY2xpZW50UmVnaW9uID0gY2xpZW50UmVnaW9uOwogIH0KCiAgdmFyIGF2ZXJhZ2ViaXRyYXRlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2F2ZXJhZ2ViaXRyYXRlJykudmFsdWU7CiAgdmFsLm1heEF2ZXJhZ2VCaXRyYXRlID0gcGFyc2VJbnQoYXZlcmFnZWJpdHJhdGUpOwogIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdwbGl2b3NldHRpbmdzJywgSlNPTi5zdHJpbmdpZnkodmFsKSk7CiAgY29uc29sZS5sb2coJ3BsaXZvc2V0dGluZ3MgdXBkYXRlZCEnKTsKfQoKZnVuY3Rpb24gdXBkYXRlRWxlbWVudHNJbkNvbmZpZyhhY2Nlc3MsIGVsZW1lbnQxLCBlbGVtZW50MikgewogIGlmIChhY2Nlc3MpIHsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGVsZW1lbnQxKS5jaGVja2VkID0gdHJ1ZTsKICB9IGVsc2UgewogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZWxlbWVudDIpLmNoZWNrZWQgPSB0cnVlOwogIH0KfQoKZnVuY3Rpb24gY2hhbmdlVmFsKHZhbCwgYWNjZXNzLCBlbGVtZW50LCBleHBlY3RlZCkgewogIGlmICghYWNjZXNzKSB7CiAgICB2YWxbZWxlbWVudF0gPSBleHBlY3RlZDsKICB9Cn0KCmZ1bmN0aW9uIGN1c3RvbUFsZXJ0KGhlYWRlciwgYWxlcnRNZXNzYWdlLCB0eXBlKSB7CiAgdmFyIGNsb3NlQWxlcnQgPSBNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zdWJzdHJpbmcoNyk7CiAgdmFyIHR5cGVDbGFzcyA9ICIiOwoKICBpZiAodHlwZSA9PSAiaW5mbyIpIHsKICAgIHR5cGVDbGFzcyA9ICJhbGVydGluZm8iOwogIH0gZWxzZSBpZiAodHlwZSA9PSAid2FybiIpIHsKICAgIHR5cGVDbGFzcyA9ICJhbGVydHdhcm4iOwogIH0KCiAgJCgiLmFsZXJ0bXNnIikuYXBwZW5kKCc8ZGl2IGlkPSJhbGVydCcgKyBjbG9zZUFsZXJ0ICsgJyIgY2xhc3M9ImN1c3RvbUFsZXJ0JyArICcgJyArIHR5cGVDbGFzcyArICciPicgKyAnPHNwYW4gc3R5bGU9Im1hcmdpbi1sZWZ0OjIwcHg7Ij4nICsgaGVhZGVyICsgJyB8IDwvc3Bhbj4nICsgJzxzcGFuIHN0eWxlPSJtYXJnaW4tbGVmdDoyMHB4OyI+JyArIGFsZXJ0TWVzc2FnZSArICcgPC9zcGFuPicgKyAnPHNwYW4gYXJpYS1oaWRkZW49InRydWUiIG9uY2xpY2s9ImNsb3NlTWV0cmljcyh0aGlzKSIgc3R5bGU9Im1hcmdpbi1sZWZ0OjI1cHg7Y3Vyc29yOnBvaW50ZXI7Ij5YPC9zcGFuPicgKyAnPC9kaXY+Jyk7CiAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAkKCcjJyArICdhbGVydCcgKyBjbG9zZUFsZXJ0KS5yZW1vdmUoKTsKICB9LCA1MDAwKTsKfQoKZnVuY3Rpb24gdXBkYXRlQXVkaW9EZXZpY2VzKCkgewogIC8vIFJlbW92ZSBleGlzdGluZyBvcHRpb25zIGlmIGFueQogIF9mb3JFYWNoLmNhbGwoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnI21pY0RldiBvcHRpb24nKSwgZnVuY3Rpb24gKGUpIHsKICAgIHJldHVybiBlLnJlbW92ZSgpOwogIH0pOwoKICBfZm9yRWFjaC5jYWxsKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJyNpbnB1dERldiBvcHRpb24nKSwgZnVuY3Rpb24gKGUpIHsKICAgIHJldHVybiBlLnJlbW92ZSgpOwogIH0pOwoKICBfZm9yRWFjaC5jYWxsKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJyNvdXRwdXREZXYgb3B0aW9uJyksIGZ1bmN0aW9uIChlKSB7CiAgICByZXR1cm4gZS5yZW1vdmUoKTsKICB9KTsKCiAgX2ZvckVhY2guY2FsbChkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcjcmluZ3RvbmVEZXYgb3B0aW9uJyksIGZ1bmN0aW9uIChlKSB7CiAgICByZXR1cm4gZS5yZW1vdmUoKTsKICB9KTsKCiAgY3VycmVudFNldE1pY0RldmljZUlkID0gcGxpdm9Ccm93c2VyU2RrLmNsaWVudC5hdWRpby5taWNyb3Bob25lRGV2aWNlcy5nZXQoKTsKICBjdXJyZW50U2V0UmluZ1RvbmVEZXZpY2VJZCA9IHBsaXZvQnJvd3NlclNkay5jbGllbnQuYXVkaW8ucmluZ3RvbmVEZXZpY2VzLmdldCgpOwogIGN1cnJlbnRTZXRTcGVha2VyRGV2aWNlSWQgPSBwbGl2b0Jyb3dzZXJTZGsuY2xpZW50LmF1ZGlvLnNwZWFrZXJEZXZpY2VzLmdldCgpOwogIHBsaXZvQnJvd3NlclNkay5jbGllbnQuYXVkaW8uYXZhaWxhYmxlRGV2aWNlcygpLnRoZW4oZnVuY3Rpb24gKGUpIHsKICAgIGUuZm9yRWFjaChmdW5jdGlvbiAoZGV2KSB7CiAgICAgIGlmIChkZXYubGFiZWwgJiYgZGV2LmtpbmQgPT0gImF1ZGlvaW5wdXQiKSB7CiAgICAgICAgaWYgKGN1cnJlbnRTZXRNaWNEZXZpY2VJZCA9PSAiIiB8fCBjdXJyZW50U2V0TWljRGV2aWNlSWQgIT0gZGV2LmRldmljZUlkKSB7CiAgICAgICAgICAkKCcjbWljRGV2JykuYXBwZW5kKCc8b3B0aW9uIHZhbHVlPScgKyBkZXYuZGV2aWNlSWQgKyAnPicgKyBkZXYubGFiZWwgKyAnPC9vcHRpb24+Jyk7CiAgICAgICAgICAkKCcjaW5wdXREZXYnKS5hcHBlbmQoJzxvcHRpb24gdmFsdWU9JyArIGRldi5kZXZpY2VJZCArICc+JyArIGRldi5sYWJlbCArICc8L29wdGlvbj4nKTsKICAgICAgICB9IGVsc2UgaWYgKGN1cnJlbnRTZXRNaWNEZXZpY2VJZCA9PSBkZXYuZGV2aWNlSWQpIHsKICAgICAgICAgICQoJyNtaWNEZXYnKS5hcHBlbmQoJzxvcHRpb24gdmFsdWU9JyArIGRldi5kZXZpY2VJZCArICcgc2VsZWN0ZWQgPicgKyBkZXYubGFiZWwgKyAnPC9vcHRpb24+Jyk7CiAgICAgICAgICAkKCcjaW5wdXREZXYnKS5hcHBlbmQoJzxvcHRpb24gdmFsdWU9JyArIGRldi5kZXZpY2VJZCArICcgc2VsZWN0ZWQgPicgKyBkZXYubGFiZWwgKyAnPC9vcHRpb24+Jyk7CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAoZGV2LmxhYmVsICYmIGRldi5raW5kID09ICJhdWRpb291dHB1dCIpIHsKICAgICAgICBpZiAoY3VycmVudFNldFJpbmdUb25lRGV2aWNlSWQgPT0gIiIgfHwgY3VycmVudFNldFJpbmdUb25lRGV2aWNlSWQgIT0gZGV2LmRldmljZUlkKSB7CiAgICAgICAgICAkKCcjcmluZ3RvbmVEZXYnKS5hcHBlbmQoJzxvcHRpb24gdmFsdWU9JyArIGRldi5kZXZpY2VJZCArICc+JyArIGRldi5sYWJlbCArICc8L29wdGlvbj4nKTsKICAgICAgICB9IGVsc2UgaWYgKGN1cnJlbnRTZXRSaW5nVG9uZURldmljZUlkID09IGRldi5kZXZpY2VJZCkgewogICAgICAgICAgJCgnI3Jpbmd0b25lRGV2JykuYXBwZW5kKCc8b3B0aW9uIHZhbHVlPScgKyBkZXYuZGV2aWNlSWQgKyAnIHNlbGVjdGVkID4nICsgZGV2LmxhYmVsICsgJzwvb3B0aW9uPicpOwogICAgICAgIH0KCiAgICAgICAgaWYgKGN1cnJlbnRTZXRTcGVha2VyRGV2aWNlSWQgPT0gIiIgfHwgY3VycmVudFNldFNwZWFrZXJEZXZpY2VJZCAhPSBkZXYuZGV2aWNlSWQpIHsKICAgICAgICAgICQoJyNzcGVha2VyRGV2JykuYXBwZW5kKCc8b3B0aW9uIHZhbHVlPScgKyBkZXYuZGV2aWNlSWQgKyAnPicgKyBkZXYubGFiZWwgKyAnPC9vcHRpb24+Jyk7CiAgICAgICAgICAkKCcjb3V0cHV0RGV2JykuYXBwZW5kKCc8b3B0aW9uIHZhbHVlPScgKyBkZXYuZGV2aWNlSWQgKyAnPicgKyBkZXYubGFiZWwgKyAnPC9vcHRpb24+Jyk7CiAgICAgICAgfSBlbHNlIGlmIChjdXJyZW50U2V0U3BlYWtlckRldmljZUlkID09IGRldi5kZXZpY2VJZCkgewogICAgICAgICAgJCgnI3NwZWFrZXJEZXYnKS5hcHBlbmQoJzxvcHRpb24gdmFsdWU9JyArIGRldi5kZXZpY2VJZCArICcgc2VsZWN0ZWQgPicgKyBkZXYubGFiZWwgKyAnPC9vcHRpb24+Jyk7CiAgICAgICAgICAkKCcjb3V0cHV0RGV2JykuYXBwZW5kKCc8b3B0aW9uIHZhbHVlPScgKyBkZXYuZGV2aWNlSWQgKyAnIHNlbGVjdGVkID4nICsgZGV2LmxhYmVsICsgJzwvb3B0aW9uPicpOwogICAgICAgIH0KICAgICAgfQogICAgfSk7CiAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7CiAgICBjb25zb2xlLmVycm9yKGVycm9yKTsKICB9KTsKfQoKZnVuY3Rpb24gY2xlYXJTdGFycygpIHsKICB2YXIgc3RhcnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuc3RhcicpOwoKICBmb3IgKGkgPSAwOyBpIDwgc3RhcnMubGVuZ3RoOyBpKyspIHsKICAgICQoc3RhcnNbaV0pLnJlbW92ZUNsYXNzKCdzZWxlY3RlZCcpOwogIH0KCiAgX2ZvckVhY2guY2FsbChkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdbbmFtZT0iY2FsbHF1YWxpdHljaGVjayJdJyksIGZ1bmN0aW9uIChlKSB7CiAgICBlLmNoZWNrZWQgPyBlLmNoZWNrZWQgPSBmYWxzZSA6IG51bGw7CiAgfSk7CgogIHNlbmRGZWVkYmFja0NvbW1lbnQudmFsdWUgPSAiIjsKfQoKZnVuY3Rpb24gY2hlY2tCcm93c2VyQ29tcGxhaW5jZShjbGllbnQpIHsKICBpZiAoY2xpZW50LmJyb3dzZXJEZXRhaWxzLmJyb3dzZXIgIT0gImNocm9tZSIpIHsKICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ1tocmVmPSIjcG9wQXVkaW9EZXZpY2VzIl0nKS5mb3JFYWNoKGZ1bmN0aW9uIChlbCkgewogICAgICByZXR1cm4gZWwucmVtb3ZlKCk7CiAgICB9KTsKICB9Cn0KCmZ1bmN0aW9uIHRyaW1TcGFjZShlKSB7CiAgZS52YWx1ZSA9IGUudmFsdWUucmVwbGFjZSgvWy0gKCldL2csICcnKTsKfQoKZnVuY3Rpb24gY2FsbGVySWRBUEkodXNlcm5hbWUsIGlkLCB0eXBlKSB7CiAgJC5nZXQoImh0dHBzOi8vcHhtbC5oZXJva3VhcHAuY29tL3VwZGF0ZUNhbGxlcklkIiwgewogICAgdXNlcm5hbWU6IHVzZXJuYW1lLAogICAgY2FsbGVySWQ6IGlkLAogICAgdHlwZTogdHlwZQogIH0sIGZ1bmN0aW9uIChlKSB7CiAgICBjb25zb2xlLmxvZygic3VjY2VzcyIsIGUpOwogIH0pLmRvbmUoZnVuY3Rpb24gKGUpIHsKICAgIGNvbnNvbGUubG9nKCJkb25lIiwgZSk7CiAgfSkuZmFpbChmdW5jdGlvbiAoZSkgewogICAgY29uc29sZS5sb2coImZhaWwiLCBlKTsKICB9KTsKfQoKZnVuY3Rpb24gc2F2ZUNhbGxlcklkKGlkKSB7CiAgaWYgKCFpZCkgewogICAgY29uc29sZS53YXJuKCdjYWxsZXJJZCB5b3Ugc2V0IGlzOiAnICsgaWQpOwogICAgY3VzdG9tQWxlcnQoJ2NhbGxlcklkJywgJ2VtcHR5JywgJ3dhcm4nKTsKICAgIHJldHVybjsKICB9CgogIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdjYWxsZXJJZCcsIGlkKTsKICBjb25zb2xlLmxvZygnY2FsbGVySWQgc2F2ZWQgYXMgOicsIGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdjYWxsZXJJZCcpKTsKCiAgaWYgKHBsaXZvQnJvd3NlclNkay5jbGllbnQudXNlck5hbWUpIHsKICAgIGNhbGxlcklkQVBJKHBsaXZvQnJvd3NlclNkay5jbGllbnQudXNlck5hbWUsIGlkLCAiYWRkIik7CiAgfQoKICBjdXN0b21BbGVydCgnY2FsbGVySWQnLCAnc2F2ZWQ6ICcgKyBpZCwgJ2luZm8nKTsKfQoKZnVuY3Rpb24gcmVtb3ZlQ2FsbGVySWQoKSB7CiAgaWYgKGxvY2FsU3RvcmFnZS5oYXNPd25Qcm9wZXJ0eSgnY2FsbGVySWQnKSkgewogICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oJ2NhbGxlcklkJyk7CiAgICB2YXIgaWQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2FsbGVyaWQnKTsKICAgIGNvbnNvbGUuZGVidWcoJ2NhbGxlcklkIHJlbW92ZWQnKTsKCiAgICBpZiAocGxpdm9Ccm93c2VyU2RrLmNsaWVudC51c2VyTmFtZSkgewogICAgICBjYWxsZXJJZEFQSShwbGl2b0Jyb3dzZXJTZGsuY2xpZW50LnVzZXJOYW1lLCBpZC52YWx1ZSwgInJlbW92ZSIpOwogICAgfQoKICAgIGlkLnZhbHVlID0gIiI7CiAgICBjdXN0b21BbGVydCgnY2FsbGVySWQnLCAncmVtb3ZlZCcsICdpbmZvJyk7CiAgfSBlbHNlIHsKICAgIGN1c3RvbUFsZXJ0KCdjYWxsZXJJZCcsICdub3QgcHJlc2VudCcsICd3YXJuJyk7CiAgfQp9CgpmdW5jdGlvbiBzZXRJdGkoaW5zdGFuY2UpIHsKICBpdGkgPSBpbnN0YW5jZTsKfQoKZnVuY3Rpb24gcmVzZXRNdXRlKCkgewogIHRtdXRlLnNldEF0dHJpYnV0ZSgnZGF0YS10b2dnbGUnLCAnbXV0ZScpOwogICQoJy50bXV0ZScpLmF0dHIoJ2NsYXNzJywgJ2ZhIHRtdXRlIGZhLW1pY3JvcGhvbmUgZmEtbGcgY2FsbGluZm9JY29uJyk7Cn0KCmZ1bmN0aW9uIHZvbHVtZShhdWRpb1N0YXRzKSB7CiAgaW5wdXRWb2x1bWUgPSBhdWRpb1N0YXRzLmlucHV0Vm9sdW1lOwogIG91dHB1dFZvbHVtZSA9IGF1ZGlvU3RhdHMub3V0cHV0Vm9sdW1lOwogIGNvbG9yUGlkcyhNYXRoLmZsb29yKGlucHV0Vm9sdW1lICogMzI1KSwgJ2xvY2FsYXVkaW8nKTsKICBjb2xvclBpZHMoTWF0aC5mbG9vcihvdXRwdXRWb2x1bWUgKiAzMjUpLCAncmVtb3RlYXVkaW8nKTsKfQoKZnVuY3Rpb24gYW5hbHlzZUF1ZGlvKHZvbHVtZVR5cGUpIHsKICBuYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmdldFVzZXJNZWRpYSh7CiAgICBhdWRpbzogdHJ1ZSwKICAgIHZpZGVvOiBmYWxzZQogIH0pLnRoZW4oZnVuY3Rpb24gKHN0cmVhbSkgewogICAgdmFyIGF1ZGlvQ29udGV4dCA9IG5ldyBBdWRpb0NvbnRleHQoKTsKICAgIHZhciBhbmFseXNlciA9IGF1ZGlvQ29udGV4dC5jcmVhdGVBbmFseXNlcigpOwogICAgdmFyIG1pY3JvcGhvbmUgPSBhdWRpb0NvbnRleHQuY3JlYXRlTWVkaWFTdHJlYW1Tb3VyY2Uoc3RyZWFtKTsKICAgIHZhciBqYXZhc2NyaXB0Tm9kZSA9IGF1ZGlvQ29udGV4dC5jcmVhdGVTY3JpcHRQcm9jZXNzb3IoMjA0OCwgMSwgMSk7CiAgICBhbmFseXNlci5zbW9vdGhpbmdUaW1lQ29uc3RhbnQgPSAwLjg7CiAgICBhbmFseXNlci5mZnRTaXplID0gMTAyNDsKICAgIG1pY3JvcGhvbmUuY29ubmVjdChhbmFseXNlcik7CiAgICBhbmFseXNlci5jb25uZWN0KGphdmFzY3JpcHROb2RlKTsKICAgIGphdmFzY3JpcHROb2RlLmNvbm5lY3QoYXVkaW9Db250ZXh0LmRlc3RpbmF0aW9uKTsKCiAgICBqYXZhc2NyaXB0Tm9kZS5vbmF1ZGlvcHJvY2VzcyA9IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIGFycmF5ID0gbmV3IFVpbnQ4QXJyYXkoYW5hbHlzZXIuZnJlcXVlbmN5QmluQ291bnQpOwogICAgICBhbmFseXNlci5nZXRCeXRlRnJlcXVlbmN5RGF0YShhcnJheSk7CiAgICAgIHZhciB2YWx1ZXMgPSAwOwogICAgICB2YXIgbGVuZ3RoID0gYXJyYXkubGVuZ3RoOwoKICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGxlbmd0aDsgX2krKykgewogICAgICAgIHZhbHVlcyArPSBhcnJheVtfaV07CiAgICAgIH0KCiAgICAgIHZhciBhdmVyYWdlID0gdmFsdWVzIC8gbGVuZ3RoOwogICAgICBjb2xvclBpZHMoYXZlcmFnZSwgdm9sdW1lVHlwZSk7CiAgICB9OwogIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHsKICAgIGNvbnNvbGUubG9nKCJVbmFibGUgdG8gZ2V0IHVzZXIgbWVkaWEiKTsKICB9KTsKfQoKZnVuY3Rpb24gY29sb3JQaWRzKHZvbCwgdm9sdW1lVHlwZSkgewogIHZhciBhbGxfcGlkcyA9ICQoJy5waWQnICsgdm9sdW1lVHlwZSk7CiAgdmFyIGFtb3V0X29mX3BpZHMgPSBNYXRoLnJvdW5kKHZvbCAvIDEwKTsKICB2YXIgZWxlbV9yYW5nZSA9IGFsbF9waWRzLnNsaWNlKDAsIGFtb3V0X29mX3BpZHMpOwoKICBmb3IgKHZhciBfaTIgPSAwOyBfaTIgPCBhbGxfcGlkcy5sZW5ndGg7IF9pMisrKSB7CiAgICBhbGxfcGlkc1tfaTJdLnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICIjZTZlN2U4IjsKICB9CgogIGZvciAodmFyIGogPSAwOyBqIDwgZWxlbV9yYW5nZS5sZW5ndGg7IGorKykgewogICAgZWxlbV9yYW5nZVtqXS5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAiIzY5Y2UyYiI7CiAgfQp9CgpmdW5jdGlvbiByZWZyZXNoQXVkaW9EZXZpY2VzKCkgewogIF9mb3JFYWNoLmNhbGwoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnI3BvcEF1ZGlvRGV2aWNlcyBvcHRpb24nKSwgZnVuY3Rpb24gKGUpIHsKICAgIHJldHVybiBlLnJlbW92ZSgpOwogIH0pOwoKICBwbGl2b0Jyb3dzZXJTZGsuY2xpZW50LmF1ZGlvLnJldmVhbEF1ZGlvRGV2aWNlcygpLnRoZW4oZnVuY3Rpb24gKGUpIHsKICAgIHVwZGF0ZUF1ZGlvRGV2aWNlcygpOwogICAgY29uc29sZS5sb2coJ01lZGlhIHBlcm1pc3Npb24gJywgZSk7CiAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7CiAgICBjb25zb2xlLmVycm9yKCdtZWRpYSBwZXJtaXNzaW9uIGVycm9yIDonLCBlcnJvcik7CiAgICAkKCcjbWVkaWFBY2Nlc3NCbG9jaycpLm1vZGFsKCdzaG93Jyk7CiAgfSk7Cn0KCmZ1bmN0aW9uIHNob3dPdXB1dEF1ZGlvTGV2ZWwodm9sdW1lVHlwZSkgewogIHZhciBhdWRpb0NvbnRleHQgPSBuZXcgQXVkaW9Db250ZXh0KCk7CgogIGlmICh2b2x1bWVUeXBlID09ICdzcGVha2Vyb3V0cHV0JykgewogICAgc3BlYWtlclNvdXJjZU5vZGUgPSBhdWRpb0NvbnRleHQuY3JlYXRlQnVmZmVyU291cmNlKCk7CiAgfSBlbHNlIHsKICAgIHJpbmd0b25lU291cmNlTm9kZSA9IGF1ZGlvQ29udGV4dC5jcmVhdGVCdWZmZXJTb3VyY2UoKTsKICB9CgogIHZhciByZXF1ZXN0ID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7CiAgcmVxdWVzdC5vcGVuKCdHRVQnLCAnbWVkaWEvdXMtcmluZy5tcDMnLCB0cnVlKTsKICByZXF1ZXN0LnJlc3BvbnNlVHlwZSA9ICdhcnJheWJ1ZmZlcic7IC8vIFdoZW4gbG9hZGVkLCBkZWNvZGUgdGhlIGRhdGEgYW5kIHBsYXkgdGhlIHNvdW5kCgogIHJlcXVlc3Qub25sb2FkID0gZnVuY3Rpb24gKCkgewogICAgYXVkaW9Db250ZXh0LmRlY29kZUF1ZGlvRGF0YShyZXF1ZXN0LnJlc3BvbnNlLCBmdW5jdGlvbiAoYnVmZmVyKSB7CiAgICAgIGlmICh2b2x1bWVUeXBlID09ICdzcGVha2Vyb3V0cHV0JykgewogICAgICAgIHNwZWFrZXJTb3VyY2VOb2RlLmJ1ZmZlciA9IGJ1ZmZlcjsKICAgICAgICBzcGVha2VyU291cmNlTm9kZS5zdGFydCgwKTsKICAgICAgICBzcGVha2VyU291cmNlTm9kZS5sb29wID0gdHJ1ZTsKICAgICAgfSBlbHNlIHsKICAgICAgICByaW5ndG9uZVNvdXJjZU5vZGUuYnVmZmVyID0gYnVmZmVyOwogICAgICAgIHJpbmd0b25lU291cmNlTm9kZS5zdGFydCgwKTsKICAgICAgICByaW5ndG9uZVNvdXJjZU5vZGUubG9vcCA9IHRydWU7CiAgICAgIH0KICAgIH0pOwogIH07CgogIHJlcXVlc3Quc2VuZCgpOyAvLyBBbmFseXNlIGF1ZGlvCgogIHZhciBhbmFseXNlciA9IGF1ZGlvQ29udGV4dC5jcmVhdGVBbmFseXNlcigpOwogIHZhciBqYXZhc2NyaXB0Tm9kZSA9IGF1ZGlvQ29udGV4dC5jcmVhdGVTY3JpcHRQcm9jZXNzb3IoMjA0OCwgMSwgMSk7CiAgYW5hbHlzZXIuc21vb3RoaW5nVGltZUNvbnN0YW50ID0gMC44OwogIGFuYWx5c2VyLmZmdFNpemUgPSA2NDsKCiAgaWYgKHZvbHVtZVR5cGUgPT0gJ3NwZWFrZXJvdXRwdXQnKSB7CiAgICBzcGVha2VyU291cmNlTm9kZS5jb25uZWN0KGF1ZGlvQ29udGV4dC5kZXN0aW5hdGlvbik7CiAgICBzcGVha2VyU291cmNlTm9kZS5jb25uZWN0KGFuYWx5c2VyKTsKICB9IGVsc2UgewogICAgcmluZ3RvbmVTb3VyY2VOb2RlLmNvbm5lY3QoYXVkaW9Db250ZXh0LmRlc3RpbmF0aW9uKTsKICAgIHJpbmd0b25lU291cmNlTm9kZS5jb25uZWN0KGFuYWx5c2VyKTsKICB9CgogIGFuYWx5c2VyLmNvbm5lY3QoamF2YXNjcmlwdE5vZGUpOwogIGphdmFzY3JpcHROb2RlLmNvbm5lY3QoYXVkaW9Db250ZXh0LmRlc3RpbmF0aW9uKTsKCiAgamF2YXNjcmlwdE5vZGUub25hdWRpb3Byb2Nlc3MgPSBmdW5jdGlvbiAoKSB7CiAgICB2YXIgYXJyYXkgPSBuZXcgVWludDhBcnJheShhbmFseXNlci5mcmVxdWVuY3lCaW5Db3VudCk7CiAgICBhbmFseXNlci5nZXRCeXRlRnJlcXVlbmN5RGF0YShhcnJheSk7CiAgICB2YXIgdmFsdWVzID0gMDsKICAgIHZhciBsZW5ndGggPSBhcnJheS5sZW5ndGg7CgogICAgZm9yICh2YXIgX2kzID0gMDsgX2kzIDwgbGVuZ3RoOyBfaTMrKykgewogICAgICB2YWx1ZXMgKz0gYXJyYXlbX2kzXTsKICAgIH0KCiAgICB2YXIgYXZlcmFnZSA9IHZhbHVlcyAvIChsZW5ndGggLyAyKTsKCiAgICBpZiAoYXZlcmFnZSAhPSAwKSB7CiAgICAgIGNvbG9yUGlkcyhhdmVyYWdlLCB2b2x1bWVUeXBlKTsKICAgIH0KICB9Owp9CgpmdW5jdGlvbiBzdG9wT3V0cHV0QXVkaW9MZXZlbCh2b2x1bWVUeXBlKSB7CiAgaWYgKHZvbHVtZVR5cGUgPT0gJ3NwZWFrZXJvdXRwdXQnKSB7CiAgICBzcGVha2VyU291cmNlTm9kZS5zdG9wKDApOwogIH0KCiAgaWYgKHZvbHVtZVR5cGUgPT0gJ3JpbmdvdXRwdXQnKSB7CiAgICByaW5ndG9uZVNvdXJjZU5vZGUuc3RvcCgwKTsKICB9Cn0KCmZ1bmN0aW9uIGhpZGVLZXlwYWRJbmZvKCkgewogICQoJy5pdGknKS5oaWRlKCk7CiAgJCgnI3RvTnVtYmVyJykuaGlkZSgpOwogICQoJy5jYWxsZXJpZGluZm8nKS5oaWRlKCk7CiAgJCgnI21ha2VjYWxsJykuaGlkZSgpOwogICQoJy5taWNzZXR0aW5nc2xpbmsnKS5oaWRlKCk7Cn0KCmZ1bmN0aW9uIHNob3dLZXlwYWRJbmZvKCkgewogIHZhciBwaG9uZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwaG9uZScpOwogIHBob25lLnN0eWxlLnJlbW92ZVByb3BlcnR5KCJ3aWR0aCIpOwogIHBob25lLnN0eWxlLnJlbW92ZVByb3BlcnR5KCJtYXJnaW4tbGVmdCIpOwogIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2dpbmtleXBhZCcpLmFwcGVuZENoaWxkKHBob25lKTsKICAkKCcjcGhvbmUnKS5zaG93KCk7CiAgJCgnLmNhbGxpbmZvJykuaGlkZSgpOwogICQoJy5pdGknKS5zaG93KCk7CiAgJCgnI3RvTnVtYmVyJykuc2hvdygpOwogICQoJy5jYWxsZXJpZGluZm8nKS5zaG93KCk7CiAgJCgnI21ha2VjYWxsJykuc2hvdygpOwogICQoJy5taWNzZXR0aW5nc2xpbmsnKS5zaG93KCk7CiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Nob3dLZXlwYWQnKS52YWx1ZSA9ICdzaG93S2V5cGFkJzsKICAkKCcjc2hvd0tleXBhZCcpLmh0bWwoJ1NIT1cgS0VZUEFEJyk7Cn0KLyoNCglDYXB0dXJlIFVJIG9uY2xpY2sgdHJpZ2dlcnMNCiovCgoKJCgnLmhhbmd1cCcpLmNsaWNrKGZ1bmN0aW9uICgpIHsKICBjb25zb2xlLmluZm8oJ0hhbmd1cCcpOwoKICBpZiAocGxpdm9Ccm93c2VyU2RrLmNsaWVudC5jYWxsU2Vzc2lvbikgewogICAgcGxpdm9Ccm93c2VyU2RrLmNsaWVudC5oYW5ndXAoKTsKICAgIHNob3dLZXlwYWRJbmZvKCk7CiAgfSBlbHNlIHsKICAgIGNhbGxPZmYoKTsKICB9Cn0pOwokKCcuYW5zd2VySW5jb21pbmcnKS5jbGljayhmdW5jdGlvbiAoKSB7CiAgaXNJbmNvbWluZ0NhbGxQcmVzZW50ID0gZmFsc2U7CiAgY29uc29sZS5pbmZvKCdDYWxsIGFjY2VwdCBjbGlja2VkJyk7CgogIGlmIChpbmNvbWluZ0NhbGxJbmZvKSB7CiAgICBwbGl2b0Jyb3dzZXJTZGsuY2xpZW50LmFuc3dlcihpbmNvbWluZ0NhbGxJbmZvLmNhbGxVVUlEKTsKICB9IGVsc2UgewogICAgcGxpdm9Ccm93c2VyU2RrLmNsaWVudC5hbnN3ZXIoKTsKICB9CgogICQoJy5pbmNvbWluZ0NhbGxEZWZhdWx0JykuaGlkZSgpOwogICQoJy5jYWxsaW5mbycpLnNob3coKTsKfSk7CiQoJy5yZWplY3RJbmNvbWluZycpLmNsaWNrKGZ1bmN0aW9uICgpIHsKICBpc0luY29taW5nQ2FsbFByZXNlbnQgPSBmYWxzZTsKICBjb25zb2xlLmluZm8oJ0NhbGwgcmVqZWN0ZWQnKTsKCiAgaWYgKGluY29taW5nQ2FsbEluZm8pIHsKICAgIHBsaXZvQnJvd3NlclNkay5jbGllbnQucmVqZWN0KGluY29taW5nQ2FsbEluZm8uY2FsbFVVSUQpOwogIH0gZWxzZSB7CiAgICBwbGl2b0Jyb3dzZXJTZGsuY2xpZW50LnJlamVjdCgpOwogIH0KCiAgJCgnLmluY29taW5nQ2FsbERlZmF1bHQnKS5oaWRlKCk7Cn0pOwokKCcuaWdub3JlSW5jb21pbmcnKS5jbGljayhmdW5jdGlvbiAoKSB7CiAgaXNJbmNvbWluZ0NhbGxQcmVzZW50ID0gZmFsc2U7CiAgY29uc29sZS5pbmZvKCdDYWxsIGlnbm9yZWQnKTsKCiAgaWYgKGluY29taW5nQ2FsbEluZm8pIHsKICAgIHBsaXZvQnJvd3NlclNkay5jbGllbnQuaWdub3JlKGluY29taW5nQ2FsbEluZm8uY2FsbFVVSUQpOwogIH0gZWxzZSB7CiAgICBwbGl2b0Jyb3dzZXJTZGsuY2xpZW50Lmlnbm9yZSgpOwogIH0KCiAgJCgnLmluY29taW5nQ2FsbERlZmF1bHQnKS5oaWRlKCk7Cn0pOwokKCcjdG11dGUnKS5jbGljayhmdW5jdGlvbiAoZSkgewogIHZhciBldmVudCA9IGUuY3VycmVudFRhcmdldC5nZXRBdHRyaWJ1dGUoJ2RhdGEtdG9nZ2xlJyk7CgogIGlmIChldmVudCA9PSAibXV0ZSIpIHsKICAgIHBsaXZvQnJvd3NlclNkay5jbGllbnQubXV0ZSgpOwogICAgZS5jdXJyZW50VGFyZ2V0LnNldEF0dHJpYnV0ZSgnZGF0YS10b2dnbGUnLCAndW5tdXRlJyk7CiAgICAkKCcudG11dGUnKS5hdHRyKCdjbGFzcycsICdmYSB0bXV0ZSBmYS1taWNyb3Bob25lLXNsYXNoIGZhLWxnIGNhbGxpbmZvSWNvbicpOwogIH0gZWxzZSB7CiAgICBwbGl2b0Jyb3dzZXJTZGsuY2xpZW50LnVubXV0ZSgpOwogICAgZS5jdXJyZW50VGFyZ2V0LnNldEF0dHJpYnV0ZSgnZGF0YS10b2dnbGUnLCAnbXV0ZScpOwogICAgJCgnLnRtdXRlJykuYXR0cignY2xhc3MnLCAnZmEgdG11dGUgZmEtbWljcm9waG9uZSBmYS1sZyBjYWxsaW5mb0ljb24nKTsKICB9Cn0pOwokKCcjbWFrZWNhbGwnKS5jbGljayhmdW5jdGlvbiAoZSkgewogIHZhciB0byA9IGl0aS5nZXROdW1iZXIoKSwKICAgICAgZXh0cmFIZWFkZXJzID0ge30sCiAgICAgIGN1c3RvbUNhbGxlcklkID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2NhbGxlcklkJyk7CgogIGlmIChjdXN0b21DYWxsZXJJZCkgewogICAgY3VzdG9tQ2FsbGVySWQgPSBjdXN0b21DYWxsZXJJZC5yZXBsYWNlKCIrIiwgIiIpOwogICAgZXh0cmFIZWFkZXJzID0gewogICAgICAnWC1QSC1jYWxsZXJJZCc6IGN1c3RvbUNhbGxlcklkCiAgICB9OwogIH0KCiAgZXh0cmFIZWFkZXJzWyJYLVBILWNvbmZlcmVuY2UiXSA9ICJ0cnVlIjsKICB2YXIgY2FsbEVuYWJsZWQgPSAkKCcjbWFrZWNhbGwnKS5hdHRyKCdjbGFzcycpLm1hdGNoKCdkaXNhYmxlZCcpOwoKICBpZiAoIXRvIHx8ICFwbGl2b0Jyb3dzZXJTZGsgfHwgISFjYWxsRW5hYmxlZCkgewogICAgcmV0dXJuOwogIH0KCiAgOwoKICBpZiAoIXBsaXZvQnJvd3NlclNkay5jbGllbnQuaXNMb2dnZWRJbikgewogICAgYWxlcnQoJ1lvdVwncmUgbm90IExvZ2dlZCBpbiEnKTsKICB9CgogIHBsaXZvQnJvd3NlclNkay5jbGllbnQuY2FsbCh0bywgZXh0cmFIZWFkZXJzKTsKICBjb25zb2xlLmluZm8oJ0NsaWNrIG1ha2UgY2FsbCA6ICcsIHRvKTsKICBjYWxsU3RvcmFnZS5tb2RlID0gIm91dCI7CiAgY2FsbFN0b3JhZ2Uuc3RhcnRUaW1lID0gZGF0ZSgpOwogIGNhbGxTdG9yYWdlLm51bSA9IHRvOwogICQoJy5waG9uZScpLmhpZGUoKTsKICAkKCcuQWZ0ZXJBbnN3ZXInKS5zaG93KCk7CiAgJCgnI2JvdW5kVHlwZScpLmh0bWwoJ091dGdvaW5nIDogJyArIHRvKTsKICAkKCcjY2FsbER1cmF0aW9uJykuaHRtbCgnMDA6MDA6MDAnKTsKICAkKCcuY2FsbGluZm8nKS5zaG93KCk7Cn0pOwokKCcjdXBkYXRlU2V0dGluZ3MnKS5jbGljayhmdW5jdGlvbiAoZSkgewogIHVwZGF0ZVNldHRpbmdzKGRlZmF1bHRTZXR0aW5ncyk7Cn0pOwokKCcjcmVzZXRTZXR0aW5ncycpLmNsaWNrKGZ1bmN0aW9uIChlKSB7CiAgcmVzZXRTZXR0aW5ncygpOwp9KTsKJCgnI3NhdmVDYWxsZXJJZCcpLmNsaWNrKGZ1bmN0aW9uIChlKSB7CiAgdmFyIGNhbGxlcmlkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NhbGxlcmlkJykudmFsdWU7CiAgc2F2ZUNhbGxlcklkKGNhbGxlcmlkKTsKfSk7CiQoJyNyZW1vdmVDYWxsZXJJZCcpLmNsaWNrKGZ1bmN0aW9uIChlKSB7CiAgcmVtb3ZlQ2FsbGVySWQoKTsKfSk7CiQoJyNjbGlja0NsZWFyQWxlcnRzJykuY2xpY2soZnVuY3Rpb24gKGUpIHsKICAkKCcuYWxlcnRtc2cnKS5odG1sKCcnKTsKfSk7CiQoJyNzZW5kRmVlZGJhY2snKS5jbGljayhmdW5jdGlvbiAoKSB7CiAgdmFyIHNjb3JlID0gJCgnI3N0YXJzIGxpLnNlbGVjdGVkJykubGFzdCgpLmRhdGEoJ3ZhbHVlJyk7CiAgc2NvcmUgPSBOdW1iZXIoc2NvcmUpOwogIHZhciBsYXN0Q2FsbGlkID0gcGxpdm9Ccm93c2VyU2RrLmNsaWVudC5nZXRMYXN0Q2FsbFVVSUQoKTsKICB2YXIgaXNzdWVzID0gW107CgogIF9mb3JFYWNoLmNhbGwoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnW25hbWU9ImNhbGxxdWFsaXR5Y2hlY2siXScpLCBmdW5jdGlvbiAoZSkgewogICAgaWYgKGUuY2hlY2tlZCkgewogICAgICBpc3N1ZXMucHVzaChlLnZhbHVlKTsKICAgIH0KICB9KTsKCiAgdmFyIG5vdGUgPSBzZW5kRmVlZGJhY2tDb21tZW50LnZhbHVlOwogIHZhciBzZW5kQ29uc29sZUxvZ3MgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgic2VuZENvbnNvbGVMb2dzIikuY2hlY2tlZDsgLy8gc3VibWl0Q2FsbFF1YWxpdHlGZWVkYmFjayB0YWtlcyBwYXJhbWV0ZXJlcyBjYWxsVVVJZCwgc3RhclJhdGluZywgaXNzdWVzLCBub3RlLCBzZW5kQ29uc29sZUxvZ3MKCiAgcGxpdm9Ccm93c2VyU2RrLmNsaWVudC5zdWJtaXRDYWxsUXVhbGl0eUZlZWRiYWNrKGxhc3RDYWxsaWQsIHNjb3JlLCBpc3N1ZXMsIG5vdGUsIHNlbmRDb25zb2xlTG9ncykudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7CiAgICAkKCcjZmVlZGJhY2tTdGF0dXMnKS5odG1sKCdGZWVkYmFjayBzZW50Jyk7CiAgICAkKCcjaWdub3JlRmVlZGJhY2snKS5jbGljaygpOwogICAgY3VzdG9tQWxlcnQoJ0ZlZWRiYWNrIHNlbnQnLCAnJywgJ2luZm8nKTsKICAgICQoJy5sb3dRdWFsaXR5UmFkaW9zJykuaGlkZSgpOwogIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikgewogICAgJCgnI2ZlZWRiYWNrU3RhdHVzJykuaHRtbChlcnJvcik7CiAgICBjdXN0b21BbGVydCgnQ291bGQgbm90IHNlbmQgZmVlZGJhY2snLCAnJywgJ3dhcm4nKTsKICB9KTsKfSk7IC8vIFJlc2V0IHRoZSBmZWVkYmFjayBkaWFsb2cgd2hlbiBpZ25vcmUgY2xpY2tlZAoKJCgiI2lnbm9yZUZlZWRiYWNrIikuY2xpY2soZnVuY3Rpb24gKCkgewogICQoJyNzdGFycyBsaScpLnJlbW92ZUNsYXNzKCJzZWxlY3RlZCIpOwogICQoJyNzZW5kRmVlZGJhY2tDb21tZW50JykuZW1wdHkoKTsKICAkKCcubG93UXVhbGl0eVJhZGlvcyBpbnB1dCcpLnByb3AoJ2NoZWNrZWQnLCBmYWxzZSk7CiAgJCgiI2ZlZWRiYWNrU3RhdHVzIikuZW1wdHkoKTsKICAkKCcubG93UXVhbGl0eVJhZGlvcycpLmhpZGUoKTsKfSk7IC8vIFJlc2V0IHRoZSBmZWVkYmFjayBkaWFsb2cgd2hlbiBtb2RhbCBjbG9zZWQKCiQoJyNzZW5kUXVhbGl0eUZlZWRiYWNrJykub24oJ2hpZGRlbi5icy5tb2RhbCcsIGZ1bmN0aW9uICgpIHsKICAkKCcjc3RhcnMgbGknKS5yZW1vdmVDbGFzcygic2VsZWN0ZWQiKTsKICAkKCcjc2VuZEZlZWRiYWNrQ29tbWVudCcpLmVtcHR5KCk7CiAgJCgnLmxvd1F1YWxpdHlSYWRpb3MgaW5wdXQnKS5wcm9wKCdjaGVja2VkJywgZmFsc2UpOwogICQoIiNmZWVkYmFja1N0YXR1cyIpLmVtcHR5KCk7CiAgJCgnLmxvd1F1YWxpdHlSYWRpb3MnKS5oaWRlKCk7Cn0pOwokKCcubG9nb3V0JykuY2xpY2soZnVuY3Rpb24gKGUpIHsKICAvL3N0YXJ0IFVJIGxvYWQgc3Bpbm5lcgogIGtpY2tTdGFydE5vdygpOwogIHBsaXZvQnJvd3NlclNkay5jbGllbnQgJiYgcGxpdm9Ccm93c2VyU2RrLmNsaWVudC5sb2dvdXQoKTsKfSk7CiQoJyNjbGlja0xvZ2luJykuY2xpY2soZnVuY3Rpb24gKGUpIHsKICB2YXIgdXNlck5hbWUgPSAkKCcjbG9naW5Vc2VyJykudmFsKCk7CiAgdmFyIHBhc3N3b3JkID0gJCgnI2xvZ2luUHdkJykudmFsKCk7CiAgbG9naW4odXNlck5hbWUsIHBhc3N3b3JkKTsKfSk7IC8vIEF1ZGlvIGRldmljZSBzZWxlY3Rpb24KCiQoJyNtaWNEZXYnKS5jaGFuZ2UoZnVuY3Rpb24gKCkgewogIHZhciBzZWxlY3REZXYgPSAkKCcjbWljRGV2JykudmFsKCk7CiAgcGxpdm9Ccm93c2VyU2RrLmNsaWVudC5hdWRpby5taWNyb3Bob25lRGV2aWNlcy5zZXQoc2VsZWN0RGV2KTsKICBjb25zb2xlLmRlYnVnKCdNaWNyb3Bob25lIGRldmljZSBzZXQgdG8gOiAnLCBzZWxlY3REZXYpOwp9KTsKJCgnI3NwZWFrZXJEZXYnKS5jaGFuZ2UoZnVuY3Rpb24gKCkgewogIHZhciBzZWxlY3REZXYgPSAkKCcjc3BlYWtlckRldicpLnZhbCgpOwogIHBsaXZvQnJvd3NlclNkay5jbGllbnQuYXVkaW8uc3BlYWtlckRldmljZXMuc2V0KHNlbGVjdERldik7CiAgY29uc29sZS5kZWJ1ZygnU3BlYWtlciBkZXZpY2Ugc2V0IHRvIDogJywgc2VsZWN0RGV2KTsKfSk7CiQoJyNyaW5ndG9uZURldicpLmNoYW5nZShmdW5jdGlvbiAoKSB7CiAgdmFyIHNlbGVjdERldiA9ICQoJyNyaW5ndG9uZURldicpLnZhbCgpOwogIHBsaXZvQnJvd3NlclNkay5jbGllbnQuYXVkaW8ucmluZ3RvbmVEZXZpY2VzLnNldChzZWxlY3REZXYpOwogIGNvbnNvbGUuZGVidWcoJ1Jpbmd0b25lIGRldiBzZXQgdG8gOiAnLCBzZWxlY3REZXYpOwp9KTsKJCgnI2lucHV0RGV2JykuY2hhbmdlKGZ1bmN0aW9uICgpIHsKICB2YXIgc2VsZWN0RGV2ID0gJCgnI2lucHV0RGV2JykudmFsKCk7CiAgcGxpdm9Ccm93c2VyU2RrLmNsaWVudC5hdWRpby5taWNyb3Bob25lRGV2aWNlcy5zZXQoc2VsZWN0RGV2KTsKICBjb25zb2xlLmRlYnVnKCdNaWNyb3Bob25lIGRldmljZSBzZXQgdG8gOiAnLCBzZWxlY3REZXYpOwp9KTsKJCgnI291dHB1dERldicpLmNoYW5nZShmdW5jdGlvbiAoKSB7CiAgdmFyIHNlbGVjdERldiA9ICQoJyNvdXRwdXREZXYnKS52YWwoKTsKICBwbGl2b0Jyb3dzZXJTZGsuY2xpZW50LmF1ZGlvLnNwZWFrZXJEZXZpY2VzLnNldChzZWxlY3REZXYpOwogIGNvbnNvbGUuZGVidWcoJ1NwZWFrZXIgZGV2aWNlIHNldCB0byA6ICcsIHNlbGVjdERldik7Cn0pOyAvLyBSaW5ndG9uZSBkZXZpY2UgdGVzdAoKJCgnI3Jpbmd0b25lRGV2VGVzdCcpLmNsaWNrKGZ1bmN0aW9uICgpIHsKICB2YXIgcmluZ3RvbmVWYWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmluZ3RvbmVEZXZUZXN0JykuaW5uZXJUZXh0OyAvLyBUb2dnbGUgVGVzdAoKICBpZiAocmluZ3RvbmVWYWwgPT0gJ1Rlc3QnKSB7CiAgICBzaG93T3VwdXRBdWRpb0xldmVsKCdyaW5nb3V0cHV0Jyk7CiAgICAkKCcjcmluZ3RvbmVEZXZUZXN0JykuaHRtbCgnU3RvcCcpOwogIH0gZWxzZSBpZiAocmluZ3RvbmVWYWwgPT0gJ1N0b3AnKSB7CiAgICBzdG9wT3V0cHV0QXVkaW9MZXZlbCgncmluZ291dHB1dCcpOwogICAgJCgnI3Jpbmd0b25lRGV2VGVzdCcpLmh0bWwoJ1Rlc3QnKTsKICB9Cn0pOyAvLyBTcGVha2VyIGRldmljZSB0ZXN0CgokKCcjc3BlYWtlckRldlRlc3QnKS5jbGljayhmdW5jdGlvbiAoKSB7CiAgdmFyIHNwZWFrZXJWYWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3BlYWtlckRldlRlc3QnKS5pbm5lclRleHQ7IC8vIFRvZ2dsZSBUZXN0CgogIGlmIChzcGVha2VyVmFsID09ICdUZXN0JykgewogICAgc2hvd091cHV0QXVkaW9MZXZlbCgnc3BlYWtlcm91dHB1dCcpOwogICAgJCgnI3NwZWFrZXJEZXZUZXN0JykuaHRtbCgnU3RvcCcpOwogIH0gZWxzZSBpZiAoc3BlYWtlclZhbCA9PSAnU3RvcCcpIHsKICAgIHN0b3BPdXRwdXRBdWRpb0xldmVsKCdzcGVha2Vyb3V0cHV0Jyk7CiAgICAkKCcjc3BlYWtlckRldlRlc3QnKS5odG1sKCdUZXN0Jyk7CiAgfQp9KTsgLy9yZXZlYWxBdWRpb0RldmljZXMKCiQoJyNhbGxvd0F1ZGlvRGV2aWNlcycpLmNsaWNrKGZ1bmN0aW9uICgpIHsKICByZWZyZXNoQXVkaW9EZXZpY2VzKCk7Cn0pOwokKCcubWljc2V0dGluZ3NsaW5rJykuY2xpY2soZnVuY3Rpb24gKCkgewogIHJlZnJlc2hBdWRpb0RldmljZXMoKTsKICBhbmFseXNlQXVkaW8oJ2lucHV0Jyk7Cn0pOwokKCcjbWljbGluaycpLmNsaWNrKGZ1bmN0aW9uICgpIHsKICByZWZyZXNoQXVkaW9EZXZpY2VzKCk7Cn0pOwokKCcjc2hvd0tleXBhZCcpLmNsaWNrKGZ1bmN0aW9uICgpIHsKICB2YXIga2V5cGFkVmFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Nob3dLZXlwYWQnKS52YWx1ZTsKCiAgaWYgKGtleXBhZFZhbCA9PSAnc2hvd0tleXBhZCcpIHsKICAgIHZhciBwaG9uZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwaG9uZScpOwogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NhbGxhbnN3ZXJwYWQnKS5hcHBlbmRDaGlsZChwaG9uZSk7CiAgICBwaG9uZS5zdHlsZS53aWR0aCA9ICI4MCUiOwogICAgcGhvbmUuc3R5bGUubWFyZ2luTGVmdCA9ICIxMyUiOwogICAgJCgnI3Bob25lJykuc2hvdygpOwogICAgaGlkZUtleXBhZEluZm8oKTsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzaG93S2V5cGFkJykudmFsdWUgPSAnaGlkZUtleXBhZCc7CiAgICAkKCcjc2hvd0tleXBhZCcpLmh0bWwoJ0hJREUgS0VZUEFEJyk7CiAgfSBlbHNlIGlmIChrZXlwYWRWYWwgPT0gJ2hpZGVLZXlwYWQnKSB7CiAgICAkKCcjcGhvbmUnKS5oaWRlKCk7CiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2hvd0tleXBhZCcpLnZhbHVlID0gJ3Nob3dLZXlwYWQnOwogICAgJCgnI3Nob3dLZXlwYWQnKS5odG1sKCdTSE9XIEtFWVBBRCcpOwogIH0KfSk7CiQoJy5udW0nKS5jbGljayhmdW5jdGlvbiAoKSB7CiAgdmFyIG51bSA9ICQodGhpcyk7CiAgdmFyIHRleHQgPSAkLnRyaW0obnVtLmZpbmQoJy50eHQnKS5jbG9uZSgpLmNoaWxkcmVuKCkucmVtb3ZlKCkuZW5kKCkudGV4dCgpKTsKICB2YXIgdGVsTnVtYmVyID0gJCgnI3RvTnVtYmVyJyk7CiAgJCh0ZWxOdW1iZXIpLnZhbCh0ZWxOdW1iZXIudmFsKCkgKyB0ZXh0KTsKCiAgaWYgKHBsaXZvQnJvd3NlclNkayAmJiBwbGl2b0Jyb3dzZXJTZGsuY2xpZW50LmNhbGxTZXNzaW9uKSB7CiAgICBwbGl2b0Jyb3dzZXJTZGsuY2xpZW50LnNlbmREdG1mKHRleHQpOwogIH0KfSk7CgpmdW5jdGlvbiBzdGFyRmVlZGJhY2soKSB7CiAgJCgnI3N0YXJzIGxpJykub24oJ21vdXNlb3ZlcicsIGZ1bmN0aW9uICgpIHsKICAgIHZhciBvblN0YXIgPSBwYXJzZUludCgkKHRoaXMpLmRhdGEoJ3ZhbHVlJyksIDEwKTsgLy8gVGhlIHN0YXIgY3VycmVudGx5IG1vdXNlIG9uCiAgICAvLyBOb3cgaGlnaGxpZ2h0IGFsbCB0aGUgc3RhcnMgYWZ0ZXIgdGhlIGN1cnJlbnQgaG92ZXJlZCBzdGFyCgogICAgJCh0aGlzKS5wYXJlbnQoKS5jaGlsZHJlbignbGkuc3RhcicpLmVhY2goZnVuY3Rpb24gKGUpIHsKICAgICAgaWYgKGUgPCBvblN0YXIpIHsKICAgICAgICAkKHRoaXMpLmFkZENsYXNzKCdob3ZlcicpOwogICAgICB9IGVsc2UgewogICAgICAgICQodGhpcykucmVtb3ZlQ2xhc3MoJ2hvdmVyJyk7CiAgICAgIH0KICAgIH0pOwogIH0pLm9uKCdtb3VzZW91dCcsIGZ1bmN0aW9uICgpIHsKICAgICQodGhpcykucGFyZW50KCkuY2hpbGRyZW4oJ2xpLnN0YXInKS5lYWNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICQodGhpcykucmVtb3ZlQ2xhc3MoJ2hvdmVyJyk7CiAgICB9KTsKICB9KTsgLy9BY3Rpb24gdG8gcGVyZm9ybSBvbiBjbGljayAqLwoKICAkKCcjc3RhcnMgbGknKS5vbignY2xpY2snLCBmdW5jdGlvbiAoKSB7CiAgICB2YXIgb25TdGFyID0gcGFyc2VJbnQoJCh0aGlzKS5kYXRhKCd2YWx1ZScpLCAxMCk7IC8vIFRoZSBzdGFyIGN1cnJlbnRseSBzZWxlY3RlZAoKICAgIHZhciBzdGFycyA9ICQodGhpcykucGFyZW50KCkuY2hpbGRyZW4oJ2xpLnN0YXInKTsKCiAgICBmb3IgKGkgPSAwOyBpIDwgc3RhcnMubGVuZ3RoOyBpKyspIHsKICAgICAgJChzdGFyc1tpXSkucmVtb3ZlQ2xhc3MoJ3NlbGVjdGVkJyk7CiAgICB9CgogICAgZm9yIChpID0gMDsgaSA8IG9uU3RhcjsgaSsrKSB7CiAgICAgICQoc3RhcnNbaV0pLmFkZENsYXNzKCdzZWxlY3RlZCcpOwogICAgfQoKICAgIHZhciB2YWx1ZSA9IHBhcnNlSW50KCQoJyNzdGFycyBsaS5zZWxlY3RlZCcpLmxhc3QoKS5kYXRhKCd2YWx1ZScpLCAxMCk7CgogICAgaWYgKHZhbHVlIDwgNSkgewogICAgICAkKCcubG93UXVhbGl0eVJhZGlvcycpLnNob3coKTsKICAgIH0gZWxzZSB7CiAgICAgICQoJy5sb3dRdWFsaXR5UmFkaW9zJykuaGlkZSgpOwogICAgfQogIH0pOwp9IC8vIHZhcmlhYmxlcyB0byBkZWNsYXJlCgoKdmFyIHBsaXZvQnJvd3NlclNkazsgLy8gdGhpcyB3aWxsIGJlIHJldHJpdmVkIGZyb20gc2V0dGluZ3MgaW4gVUkKCmZ1bmN0aW9uIGluaXRQaG9uZSh1c2VybmFtZSwgcGFzc3dvcmQpIHsKICB2YXIgb3B0aW9ucyA9IHJlZnJlc2hTZXR0aW5ncygpOwogIHBsaXZvQnJvd3NlclNkayA9IG5ldyB3aW5kb3cuUGxpdm8ob3B0aW9ucyk7CiAgcGxpdm9Ccm93c2VyU2RrLmNsaWVudC5vbignb25XZWJydGNOb3RTdXBwb3J0ZWQnLCBvbldlYnJ0Y05vdFN1cHBvcnRlZCk7CiAgcGxpdm9Ccm93c2VyU2RrLmNsaWVudC5vbignb25Mb2dpbicsIG9uTG9naW4pOwogIHBsaXZvQnJvd3NlclNkay5jbGllbnQub24oJ29uTG9nb3V0Jywgb25Mb2dvdXQpOwogIHBsaXZvQnJvd3NlclNkay5jbGllbnQub24oJ29uTG9naW5GYWlsZWQnLCBvbkxvZ2luRmFpbGVkKTsKICBwbGl2b0Jyb3dzZXJTZGsuY2xpZW50Lm9uKCdvbkNhbGxSZW1vdGVSaW5naW5nJywgb25DYWxsUmVtb3RlUmluZ2luZyk7CiAgcGxpdm9Ccm93c2VyU2RrLmNsaWVudC5vbignb25JbmNvbWluZ0NhbGxDYW5jZWxlZCcsIG9uSW5jb21pbmdDYWxsQ2FuY2VsZWQpOwogIHBsaXZvQnJvd3NlclNkay5jbGllbnQub24oJ29uSW5jb21pbmdDYWxsSWdub3JlZCcsIG9uSW5jb21pbmdDYWxsQ2FuY2VsZWQpOwogIHBsaXZvQnJvd3NlclNkay5jbGllbnQub24oJ29uQ2FsbEZhaWxlZCcsIG9uQ2FsbEZhaWxlZCk7CiAgcGxpdm9Ccm93c2VyU2RrLmNsaWVudC5vbignb25NZWRpYUNvbm5lY3RlZCcsIG9uTWVkaWFDb25uZWN0ZWQpOwogIHBsaXZvQnJvd3NlclNkay5jbGllbnQub24oJ29uQ2FsbEFuc3dlcmVkJywgb25DYWxsQW5zd2VyZWQpOwogIHBsaXZvQnJvd3NlclNkay5jbGllbnQub24oJ29uQ2FsbFRlcm1pbmF0ZWQnLCBvbkNhbGxUZXJtaW5hdGVkKTsKICBwbGl2b0Jyb3dzZXJTZGsuY2xpZW50Lm9uKCdvbkNhbGxpbmcnLCBvbkNhbGxpbmcpOwogIHBsaXZvQnJvd3NlclNkay5jbGllbnQub24oJ29uSW5jb21pbmdDYWxsJywgb25JbmNvbWluZ0NhbGwpOwogIHBsaXZvQnJvd3NlclNkay5jbGllbnQub24oJ29uTWVkaWFQZXJtaXNzaW9uJywgb25NZWRpYVBlcm1pc3Npb24pOwogIHBsaXZvQnJvd3NlclNkay5jbGllbnQub24oJ21lZGlhTWV0cmljcycsIG1lZGlhTWV0cmljcyk7CiAgcGxpdm9Ccm93c2VyU2RrLmNsaWVudC5vbignYXVkaW9EZXZpY2VDaGFuZ2UnLCBhdWRpb0RldmljZUNoYW5nZSk7CiAgcGxpdm9Ccm93c2VyU2RrLmNsaWVudC5vbignb25QZXJtaXNzaW9uRGVuaWVkJywgb25QZXJtaXNzaW9uRGVuaWVkKTsKICBwbGl2b0Jyb3dzZXJTZGsuY2xpZW50Lm9uKCdvbkNvbm5lY3Rpb25DaGFuZ2UnLCBvbkNvbm5lY3Rpb25DaGFuZ2UpOyAvLyBUbyBzaG93IGNvbm5lY3Rpb24gY2hhbmdlIGV2ZW50cwoKICBwbGl2b0Jyb3dzZXJTZGsuY2xpZW50Lm9uKCd2b2x1bWUnLCB2b2x1bWUpOyAvL29uU2Vzc2lvbkV4cGlyZWQKICAvLyBNZXRob2RzCgogIHBsaXZvQnJvd3NlclNkay5jbGllbnQuc2V0UmluZ1RvbmUodHJ1ZSk7CiAgcGxpdm9Ccm93c2VyU2RrLmNsaWVudC5zZXRSaW5nVG9uZUJhY2soZmFsc2UpOwogIHBsaXZvQnJvd3NlclNkay5jbGllbnQuc2V0Q29ubmVjdFRvbmUodHJ1ZSk7IC8vIERpYWwgYmVlcCB3aWxsIHBsYXkgdGlsbCB3ZSBnZXQgYWxlcnQgcmVzcG9uc2UgZnJvbSBuZXR3b3JrLgoKICBwbGl2b0Jyb3dzZXJTZGsuY2xpZW50LnNldERlYnVnKCJBTEwiKTsgLy8gQWxsb3dlZCB2YWx1ZXMgYXJlIE9GRiwgRVJST1IsIFdBUk4sIElORk8sIERFQlVHLCBBTEwKCiAgLyoqIEhhbmRsZSBicm93c2VyIGlzc3Vlcw0KICAgKiBTb3VuZCBkZXZpY2VzIHdvbid0IHdvcmsgaW4gZmlyZWZveA0KICAgKi8KCiAgY2hlY2tCcm93c2VyQ29tcGxhaW5jZShwbGl2b0Jyb3dzZXJTZGsuY2xpZW50KTsKICBzdGFyRmVlZGJhY2soKTsKICBjb25zb2xlLmxvZygnaW5pdFBob25lIHJlYWR5IScpOwp9"},{"version":3,"sources":["C:/wamp64/www/crm/frontend/src/functions/plivoClients.js"],"names":["audioChunks","rec","audioStreamContext","uioptions","localStorage","window","callStorage","timer","incomingNotifications","Map","speakerSourceNode","ringtoneSourceNode","incomingNotificationAlert","defaultSettings","sendDtmfType","iti","incomingCallInfo","isIncomingCallPresent","outputVolumeBar","document","getElementById","inputVolumeBar","String","prototype","calltimer","sec_num","parseInt","hours","Math","floor","minutes","seconds","_forEach","cb","i","length","$","attr","date","Date","toISOString","substring","split","kickStartNow","show","fadeIn","login","username","password","plivoBrowserSdk","client","console","error","audioDeviceChange","e","log","change","customAlert","device","kind","label","onPermissionDenied","cause","callinfo","onConnectionChange","obj","state","eventCode","eventReason","onWebrtcNotSupported","warn","alert","mediaMetrics","sessionStorage","setItem","table","classExist","querySelector","type","message","match","value","active","remove","closeAlert","random","toString","append","level","desc","setTimeout","modal","onReady","html","info","onLogin","hide","body","style","backgroundImage","userName","phone","configuration","hostport_params","innerHTML","customCallerId","getItem","callerid","onLoginFailed","reason","Object","call","JSON","stringify","performLogout","val","setCountry","clear","onLogout","onCalling","onCallRemoteRinging","callInfo","onMediaConnected","direction","onCallAnswered","src","has","callUUID","incomingCall","get","delete","clearInterval","setInterval","onCallTerminated","evt","clearStars","getCallUUID","callOff","onCallFailed","test","size","onMediaPermission","browserDetails","browser","onIncomingCall","callerName","extraHeaders","caller_Name","prevIncoming","startTime","mode","num","set","incomingNotification","Notify","success","button","answer","reject","ignore","onIncomingCallCanceled","incomingCallNotification","showKeypadInfo","resetMute","dur","closeMetrics","parentElement","resetSettings","checked","refreshSettings","getSettings","parsedSettings","parse","debug","updateElementsInConfig","permOnClick","enableTracking","closeProtection","dscp","allowMultipleIncomingCalls","clientRegion","maxAverageBitrate","updateSettings","loglevel","changeVal","averagebitrate","access","element1","element2","element","expected","header","alertMessage","typeClass","updateAudioDevices","querySelectorAll","currentSetMicDeviceId","audio","microphoneDevices","currentSetRingToneDeviceId","ringtoneDevices","currentSetSpeakerDeviceId","speakerDevices","availableDevices","then","forEach","dev","deviceId","catch","stars","removeClass","sendFeedbackComment","checkBrowserComplaince","el","trimSpace","replace","callerIdAPI","id","callerId","done","fail","saveCallerId","removeCallerId","hasOwnProperty","removeItem","setIti","instance","tmute","setAttribute","volume","audioStats","inputVolume","outputVolume","colorPids","analyseAudio","volumeType","navigator","mediaDevices","getUserMedia","video","stream","audioContext","AudioContext","analyser","createAnalyser","microphone","createMediaStreamSource","javascriptNode","createScriptProcessor","smoothingTimeConstant","fftSize","connect","destination","onaudioprocess","array","Uint8Array","frequencyBinCount","getByteFrequencyData","values","average","err","vol","all_pids","amout_of_pids","round","elem_range","slice","backgroundColor","j","refreshAudioDevices","revealAudioDevices","showOuputAudioLevel","createBufferSource","request","XMLHttpRequest","open","responseType","onload","decodeAudioData","response","buffer","start","loop","send","stopOutputAudioLevel","stop","hideKeypadInfo","removeProperty","appendChild","click","callSession","hangup","event","currentTarget","getAttribute","mute","unmute","to","getNumber","callEnabled","isLoggedIn","score","last","data","Number","lastCallid","getLastCallUUID","issues","push","note","sendConsoleLogs","submitCallQualityFeedback","result","empty","prop","on","logout","selectDev","ringtoneVal","innerText","speakerVal","keypadVal","width","marginLeft","text","trim","find","clone","children","end","telNumber","sendDtmf","starFeedback","onStar","parent","each","addClass","initPhone","options","Plivo","setRingTone","setRingToneBack","setConnectTone","setDebug"],"mappings":"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","sourcesContent":["var audioChunks,rec, audioStreamContext, uioptions,\r\n    localStorage = window.localStorage;\r\nvar callStorage = {}, timer = \"00:00:00\";\r\n\r\nconst incomingNotifications = new Map();\r\nvar speakerSourceNode;\r\nvar ringtoneSourceNode;\r\nlet incomingNotificationAlert = null;\r\n\r\nvar defaultSettings = {\r\n    \"debug\":\"INFO\",\r\n    \"permOnClick\":false,\r\n    \"codecs\":[  \"OPUS\", \"PCMU\" ],\r\n    \"enableIPV6\":false,\r\n    \"audioConstraints\":{\r\n        \"optional\":[ {\r\n            \"googAutoGainControl\":false\r\n        }]\r\n    },\r\n    \"dscp\":true,\r\n    \"enableTracking\":true,\r\n    \"closeProtection\":false,\r\n    \"maxAverageBitrate\":48000,\r\n    \"allowMultipleIncomingCalls\":false,\r\n    \"dtmfOptions\":{sendDtmfType:[\"outband\",\"inband\"]}\r\n};\r\n\r\nvar iti;\r\nvar incomingCallInfo;\r\nvar isIncomingCallPresent = false\r\n\r\nvar outputVolumeBar = document.getElementById('output-volume');\r\nvar inputVolumeBar = document.getElementById('input-volume');\r\n\r\n\r\nString.prototype.calltimer = function () {\r\n    var sec_num = parseInt(this, 10);\r\n    var hours   = Math.floor(sec_num / 3600);\r\n    var minutes = Math.floor((sec_num - (hours * 3600)) / 60);\r\n    var seconds = sec_num - (hours * 3600) - (minutes * 60);\r\n    if (hours   < 10) {hours   = \"0\"+hours;}\r\n    if (minutes < 10) {minutes = \"0\"+minutes;}\r\n    if (seconds < 10) {seconds = \"0\"+seconds;}\r\n    return hours+':'+minutes+':'+seconds;\r\n}\r\n// cross browser foreach support\r\nvar _forEach = function(cb){\r\n    for(var i=0; i<this.length; i++){\r\n        cb(this[i]);\r\n    }\r\n}\r\n\r\n// UI tweaks\r\n$('#makecall').attr('class', 'btn btn-success btn-block flatbtn makecall disabled');\r\n\r\nfunction date(){\r\n    return (new Date()).toISOString().substring(0, 10)+\" \"+Date().split(\" \")[4];\r\n}\r\n\r\nfunction kickStartNow(){\r\n    $('.loader').show();\r\n    $('.fadein-effect').fadeIn(5000);\r\n}\r\n\r\nfunction login(username, password) {\r\n    if(username && password){\r\n        //start UI load spinner\r\n        kickStartNow();\r\n        plivoBrowserSdk.client.login(username, password);\r\n    }else{\r\n        console.error('username/password missing!')\r\n    }\r\n}\r\n\r\nfunction audioDeviceChange(e){\r\n    console.log('audioDeviceChange',e);\r\n    if(e.change){\r\n        if(e.change == \"added\"){\r\n            customAlert(e.change,e.device.kind +\" - \"+e.device.label,'info');\r\n        }else{\r\n            customAlert(e.change,e.device.kind +\" - \"+e.device.label,'warn');\r\n        }\r\n    }else{\r\n        customAlert('info','There is an audioDeviceChange but mediaPermission is not allowed yet');\r\n    }\r\n}\r\n\r\nfunction onPermissionDenied(cause,callinfo){\r\n    console.log('onPermissionDenied: ',cause);\r\n    customAlert(cause,'warn');\r\n}\r\n\r\nfunction onConnectionChange(obj){\r\n    console.log('onConnectionChange: ', obj);\r\n    if(obj.state === \"connected\" ){\r\n        console.log( obj.state , \"info\", 'info');\r\n    }else if(obj.state === \"disconnected\"){\r\n        if(obj.eventCode && obj.eventReason){\r\n            customAlert( obj.state + \" \"+ obj.eventCode +\" \"+ obj.eventReason  , \"info\");\r\n        }else if(obj.eventCode && !obj.eventReason){\r\n            customAlert( obj.state + \" \"+ obj.eventCode, \"info\");\r\n        }else if(!obj.eventCode && obj.eventReason){\r\n            customAlert( obj.state + \" \"+ obj.eventReason  , \"info\");\r\n        }else{\r\n            customAlert( obj.state , \"info\");\r\n        }\r\n    }else{\r\n        console.log(\"unknown connection state \");\r\n    }\r\n}\r\n\r\nfunction onWebrtcNotSupported() {\r\n    console.warn('no webRTC support');\r\n    alert('Webrtc is not supported in this broswer, Please use latest version of chrome/firefox/opera/IE Edge');\r\n}\r\n\r\nfunction mediaMetrics(obj){\r\n    /**\r\n     * Set a trigger for Quality FB popup when there is an warning druing call using sessionStorage\r\n     * During `onCallTerminated` event check for `triggerFB` flag\r\n     */\r\n    sessionStorage.setItem('triggerFB',true);\r\n    console.table([obj]);\r\n    var classExist = document.querySelector('.-'+obj.type);\r\n    var message = obj.type;\r\n    /**\r\n     * If there is a same audio level for 3 samples then we will get a trigger\r\n     * If audio level is greater than 30 then it could be some continuous echo or user is not speaking\r\n     * Set message \"same level\" for audio greater than 30. Less than 30 could be a possible mute\r\n     */\r\n    if(obj.type.match('audio') && obj.value > 1){\r\n        message = \"same level\";\r\n    }\r\n    if(obj.active){\r\n        classExist? classExist.remove() : null;\r\n        let closeAlert = Math.random().toString(36).substring(7);\r\n        $(\".oncallalertmsg\").append(\r\n            '<div id=\"alert'+closeAlert+'\" class=\"metrics -'+obj.type+'\">' +\r\n            '<span>'+obj.level+' | </span>' +\r\n            '<span>'+message+' : '+obj.value+' | </span><span >'+obj.desc+'</span>'+\r\n            '<span aria-hidden=\"true\" onclick=\"closeMetrics(this)\" style=\"margin-left:15px;cursor:pointer;\">X</span>' +\r\n            '</div>'\r\n        );\r\n        setTimeout(function () {\r\n            $('#'+'alert'+closeAlert).remove();\r\n        }, 5000);\r\n    }\r\n    if(!obj.active && classExist){\r\n        document.querySelector('.-'+obj.type).remove();\r\n    }\r\n    // Handle no mic input even after mic access\r\n    if(obj.desc == \"no access to your microphone\"){\r\n        $('#micAccessBlock').modal({ show: true })\r\n    }\r\n}\r\n\r\nfunction onReady(){\r\n    $('#phonestatus').html('trying to login...');\r\n    console.info('Ready');\r\n}\r\n\r\nfunction onLogin(){\r\n    $('#loginContainer').hide();\r\n    $('#callContainer').show();\r\n    document.body.style.backgroundImage = 'none';\r\n    let username = plivoBrowserSdk.client.userName;\r\n    $('#sipUserName').html(username+'@'+plivoBrowserSdk.client.phone.configuration.hostport_params);\r\n    document.querySelector('title').innerHTML = username;\r\n    $('#phonestatus').html('online');\r\n    console.info('Logged in');\r\n    let customCallerId= localStorage.getItem('callerId')\r\n    if(customCallerId) {\r\n        let callerid = document.getElementById(\"callerid\");\r\n        callerid.value = customCallerId;\r\n    }\r\n    $('#makecall').attr('class', 'btn btn-success btn-block flatbtn makecall');\r\n    customAlert( \"connected\" , \"info\", 'info');\r\n    $('.loader').hide();\r\n}\r\n\r\nfunction onLoginFailed(reason){\r\n    console.info('onLoginFailed ',reason);\r\n    if(Object.prototype.toString.call(reason) == \"[object Object]\"){\r\n        reason = JSON.stringify(reason);\r\n    }\r\n    customAlert('Login failure :',reason, 'warn');\r\n    $('.loader').hide()\r\n}\r\n\r\nfunction performLogout(){\r\n    document.body.style.backgroundImage = 'url(img/background.svg)';\r\n    $('#loginContainer').show();\r\n    $('#callContainer').hide();\r\n    $('.loader').hide();\r\n    $('#toNumber').val(\"\");\r\n    iti.setCountry(\"us\");\r\n    localStorage.clear();\r\n}\r\nfunction onLogout(){\r\n    console.info('onLogout');\r\n    performLogout();\r\n}\r\n\r\n\r\nfunction onCalling(){\r\n    $('#callstatus').html('Progress...');\r\n    console.info('onCalling');\r\n}\r\n\r\nfunction onCallRemoteRinging(callInfo){\r\n    if (callInfo) console.log(JSON.stringify(callInfo));\r\n    $('#callstatus').html('Ringing...');\r\n    console.info('onCallRemoteRinging');\r\n}\r\n\r\nfunction onMediaConnected(callInfo){\r\n    if (callInfo) console.log(JSON.stringify(callInfo));\r\n    if (callInfo && callInfo.direction === 'incoming') {\r\n        $('#callstatus').html('Answered');\r\n    }\r\n    console.info('onMediaConnected');\r\n}\r\n\r\nfunction onCallAnswered(callInfo){\r\n    console.info('onCallAnswered');\r\n    if (callInfo) console.info(JSON.stringify(callInfo));\r\n    $('#callstatus').html('Answered');\r\n    $('.hangup').show();\r\n    if (callInfo && callInfo.direction === 'incoming') {\r\n        $('#phone').hide();\r\n        $('#boundType').html('Incoming : '+callInfo.src);\r\n        $('#callNum').html(callInfo.src);\r\n        $('#callDuration').html('00:00:00');\r\n        $('.callinfo').show();\r\n        if (incomingNotifications.has(callInfo.callUUID)) {\r\n            const incomingCall = incomingNotifications.get(callInfo.callUUID)\r\n            if (incomingCall)\r\n                incomingCall.hide();\r\n            incomingNotifications.delete(callInfo.callUUID);\r\n        }\r\n    }\r\n    timer = 0;\r\n    if (window.calltimer) clearInterval(window.calltimer);\r\n    window.calltimer = setInterval(function(){\r\n        timer = timer +1;\r\n        $('#callDuration').html(timer.toString().calltimer());\r\n    },1000);\r\n}\r\n\r\nfunction onCallTerminated(evt, callInfo){\r\n    $('#callstatus').html('Call Ended');\r\n    console.info(`onCallTerminated ${evt}`);\r\n    clearStars();\r\n    $('#sendQualityFeedback').modal('show');\r\n    if (callInfo && callInfo.callUUID === plivoBrowserSdk.client.getCallUUID()) {\r\n        console.info(JSON.stringify(callInfo));\r\n        callOff(evt);\r\n    } else if(!callInfo) {\r\n        callOff(evt);\r\n    }\r\n}\r\n\r\nfunction onCallFailed(reason, callInfo){\r\n    if (callInfo) {\r\n        console.log(JSON.stringify(callInfo));\r\n        console.info(`onCallFailed ${reason} ${callInfo.callUUID} ${callInfo.direction}`);\r\n    } else {\r\n        console.info(`onCallFailed ${reason}`);\r\n    }\r\n    if(reason && /Denied Media/i.test(reason)){\r\n        $('#callstatus').html('call failed');\r\n        $('#mediaAccessBlock').modal('show');\r\n    };\r\n    if (!callInfo) {\r\n        callOff(reason);\r\n        return;\r\n    }\r\n    if (incomingNotifications.has(callInfo.callUUID)) {\r\n        const incomingCall = incomingNotifications.get(callInfo.callUUID)\r\n        if(incomingCall){\r\n            incomingCall.hide();\r\n        }\r\n        incomingNotifications.delete(callInfo.callUUID);\r\n    }\r\n    if (incomingNotifications.size === 0  && !plivoBrowserSdk.client.getCallUUID()) {\r\n        callOff(reason);\r\n    } else if (incomingNotifications.size === 0 && callInfo.direction === 'outgoing') {\r\n        callOff(reason);\r\n    }\r\n}\r\n\r\nfunction onMediaPermission(evt){\r\n    console.info('onMediaPermission',evt);\r\n    if(evt.error){\r\n        customAlert('Media permission error',evt.error, 'warn');\r\n        if(client.browserDetails.browser == \"chrome\")\r\n            $('#mediaAccessBlock').modal('show');\r\n    }\r\n}\r\n\r\nfunction onIncomingCall(callerName, extraHeaders, callInfo, caller_Name){\r\n    console.info('onIncomingCall : ', callerName, extraHeaders, callInfo,caller_Name);\r\n    let prevIncoming = isIncomingCallPresent;\r\n    isIncomingCallPresent = true;\r\n    callStorage.startTime = date();\r\n    callStorage.mode = 'in';\r\n    callStorage.num = caller_Name;\r\n    if (document.getElementById('callstatus').innerHTML == 'Idle' && !prevIncoming) {\r\n        $('#incomingCallDefault').show();\r\n        $('#phone').hide();\r\n        $('#callstatus').html('Ringing...');\r\n        $('#callernum').html(caller_Name);\r\n        incomingCallInfo = callInfo;\r\n        if (callInfo) {\r\n            incomingNotifications.set(callInfo.callUUID, null);\r\n        }\r\n    } else {\r\n        $('#callstatus').html('Ringing...');\r\n        const incomingNotification = Notify.success(`Incoming Call: ${caller_Name}`)\r\n            .button('Answer', () => {\r\n                isIncomingCallPresent = false;\r\n                console.info('Call accept clicked');\r\n                if (callInfo) {\r\n                    plivoBrowserSdk.client.answer(callInfo.callUUID);\r\n                } else {\r\n                    plivoBrowserSdk.client.answer();\r\n                }\r\n            })\r\n            .button('Reject', () => {\r\n                isIncomingCallPresent = false;\r\n                console.info('callReject');\r\n                if (callInfo) {\r\n                    plivoBrowserSdk.client.reject(callInfo.callUUID);\r\n                } else {\r\n                    plivoBrowserSdk.client.reject();\r\n                }\r\n            })\r\n            .button('Ignore', () => {\r\n                isIncomingCallPresent = false;\r\n                console.info('call Ignored');\r\n                if (callInfo) {\r\n                    plivoBrowserSdk.client.ignore(callInfo.callUUID);\r\n                } else {\r\n                    plivoBrowserSdk.client.ignore();\r\n                }\r\n            });\r\n        if (callInfo) {\r\n            console.info(JSON.stringify(callInfo));\r\n            incomingNotifications.set(callInfo.callUUID, incomingNotification);\r\n        } else {\r\n            incomingNotificationAlert = incomingNotification;\r\n        }\r\n    }\r\n}\r\n\r\nfunction onIncomingCallCanceled(callInfo){\r\n    if (callInfo) console.info(JSON.stringify(callInfo));\r\n    let incomingCallNotification;\r\n    if (callInfo) {\r\n        incomingCallNotification = incomingNotifications.get(callInfo.callUUID);\r\n        incomingNotifications.delete(callInfo.callUUID);\r\n    } else if(incomingNotificationAlert) {\r\n        incomingCallNotification = incomingNotificationAlert;\r\n    }\r\n    if (incomingCallNotification) {\r\n        incomingCallNotification.hide();\r\n    }\r\n    if (incomingNotifications.size === 0 && !plivoBrowserSdk.client.getCallUUID()) {\r\n        callOff();\r\n    }\r\n}\r\n\r\nfunction callOff(reason){\r\n    $('.callinfo').hide();\r\n    $('.incomingCallDefault').hide();\r\n    showKeypadInfo();\r\n    resetMute();\r\n    window.calltimer? clearInterval(window.calltimer) : false;\r\n    callStorage.dur = timer.toString().calltimer();\r\n    if(timer == \"00:00:00\" && callStorage.mode == \"in\"){\r\n        callStorage.mode = \"missed\";\r\n    }\r\n    $('#callstatus').html('Idle');\r\n    callStorage={}; // reset callStorage\r\n    timer = \"00:00:00\"; //reset the timer\r\n\r\n}\r\n\r\n\r\nfunction closeMetrics(e){\r\n    e.parentElement.remove();\r\n}\r\n\r\nfunction resetSettings(){\r\n    document.getElementById('loglevelbtn').value = \"INFO\"\r\n    document.getElementById('onpageload').checked = true\r\n    document.getElementById('monitorquality').checked = true\r\n    document.getElementById('dontcloseprotect').checked = true\r\n    document.getElementById('allowdscp').checked = true\r\n    document.getElementById('noincoming').checked = true\r\n    document.getElementById('msregionbtn').value = \"AUTO\"\r\n    document.getElementById('averagebitrate').value = 48000\r\n    localStorage.setItem('plivosettings',JSON.stringify(defaultSettings));\r\n}\r\n\r\nfunction refreshSettings(){\r\n    var getSettings = localStorage.getItem('plivosettings');\r\n    if(getSettings){\r\n        var parsedSettings = JSON.parse(getSettings);\r\n        document.getElementById('loglevelbtn').value = parsedSettings.debug;\r\n        updateElementsInConfig(parsedSettings.permOnClick, 'oncallinit', 'onpageload');\r\n        updateElementsInConfig(parsedSettings.enableTracking, 'monitorquality', 'dontmonitorquality');\r\n        updateElementsInConfig(parsedSettings.closeProtection, 'closeprotect', 'dontcloseprotect');\r\n        updateElementsInConfig(parsedSettings.dscp, 'allowdscp', 'nodscp');\r\n        updateElementsInConfig(parsedSettings.allowMultipleIncomingCalls, 'allowincoming', 'noincoming');\r\n        if(parsedSettings.clientRegion == null) {\r\n            document.getElementById('msregionbtn').value = 'AUTO';\r\n        } else {\r\n            document.getElementById('msregionbtn').value = parsedSettings.clientRegion;\r\n        }\r\n        document.getElementById('averagebitrate').value = parsedSettings.maxAverageBitrate;\r\n        uioptions = parsedSettings;\r\n        return parsedSettings;\r\n    }else{\r\n        uioptions = defaultSettings;\r\n        return defaultSettings;\r\n    }\r\n}\r\n\r\nfunction updateSettings(val){\r\n    let loglevel = document.getElementById('loglevelbtn').value;\r\n    val.debug = loglevel;\r\n    changeVal(val, document.getElementById('onpageload').checked, 'permOnClick', true);\r\n    changeVal(val, document.getElementById('monitorquality').checked, \"enableTracking\", false);\r\n    changeVal(val, document.getElementById('dontcloseprotect').checked, \"closeProtection\", true);\r\n    changeVal(val, document.getElementById('allowdscp').checked, \"dscp\", false);\r\n    changeVal(val, document.getElementById('noincoming').checked, \"allowMultipleIncomingCalls\", true);\r\n    let clientRegion = document.getElementById('msregionbtn').value;\r\n    if(clientRegion!='AUTO') {\r\n        val.clientRegion = clientRegion;\r\n    }\r\n    let averagebitrate = document.getElementById('averagebitrate').value;\r\n    val.maxAverageBitrate = parseInt(averagebitrate);\r\n    localStorage.setItem('plivosettings',JSON.stringify(val));\r\n    console.log('plivosettings updated!')\r\n}\r\n\r\nfunction updateElementsInConfig(access, element1, element2) {\r\n    if(access) {\r\n        document.getElementById(element1).checked = true\r\n    } else {\r\n        document.getElementById(element2).checked = true\r\n    }\r\n}\r\n\r\nfunction changeVal(val, access, element, expected) {\r\n    if(!access) {\r\n        val[element] = expected;\r\n    }\r\n}\r\n\r\nfunction customAlert(header,alertMessage,type){\r\n    let closeAlert = Math.random().toString(36).substring(7);\r\n    var typeClass=\"\";\r\n    if(type == \"info\"){\r\n        typeClass = \"alertinfo\";\r\n    }else if(type == \"warn\"){\r\n        typeClass = \"alertwarn\";\r\n    }\r\n    $(\".alertmsg\").append(\r\n        '<div id=\"alert'+closeAlert+'\" class=\"customAlert'+' '+typeClass+'\">' +\r\n        '<span style=\"margin-left:20px;\">'+header+' | </span>' +\r\n        '<span style=\"margin-left:20px;\">'+alertMessage+' </span>'+\r\n        '<span aria-hidden=\"true\" onclick=\"closeMetrics(this)\" style=\"margin-left:25px;cursor:pointer;\">X</span>' +\r\n        '</div>'\r\n    );\r\n    setTimeout(function () {\r\n        $('#'+'alert'+closeAlert).remove();\r\n    }, 5000);\r\n}\r\n\r\nfunction updateAudioDevices(){\r\n    // Remove existing options if any\r\n    _forEach.call(document.querySelectorAll('#micDev option'), e=>e.remove());\r\n    _forEach.call(document.querySelectorAll('#inputDev option'), e=>e.remove());\r\n    _forEach.call(document.querySelectorAll('#outputDev option'), e=>e.remove());\r\n    _forEach.call(document.querySelectorAll('#ringtoneDev option'), e=>e.remove());\r\n    currentSetMicDeviceId = plivoBrowserSdk.client.audio.microphoneDevices.get();\r\n    currentSetRingToneDeviceId = plivoBrowserSdk.client.audio.ringtoneDevices.get();\r\n    currentSetSpeakerDeviceId = plivoBrowserSdk.client.audio.speakerDevices.get();\r\n    plivoBrowserSdk.client.audio.availableDevices()\r\n        .then(function(e){\r\n            e.forEach(function(dev){\r\n                if(dev.label && dev.kind == \"audioinput\"){\r\n                    if (currentSetMicDeviceId == \"\" || currentSetMicDeviceId != dev.deviceId){\r\n                        $('#micDev').append('<option value='+dev.deviceId+'>'+dev.label+'</option>')\r\n                        $('#inputDev').append('<option value='+dev.deviceId+'>'+dev.label+'</option>')\r\n                    }\r\n                    else if(currentSetMicDeviceId == dev.deviceId){\r\n                        $('#micDev').append('<option value='+dev.deviceId+' selected >'+dev.label+'</option>')\r\n                        $('#inputDev').append('<option value='+dev.deviceId+' selected >'+dev.label+'</option>')\r\n                    }\r\n                }\r\n                if(dev.label && dev.kind == \"audiooutput\"){\r\n                    if (currentSetRingToneDeviceId == \"\" || currentSetRingToneDeviceId != dev.deviceId){\r\n                        $('#ringtoneDev').append('<option value='+dev.deviceId+'>'+dev.label+'</option>');\r\n                    }else if(currentSetRingToneDeviceId == dev.deviceId){\r\n                        $('#ringtoneDev').append('<option value='+dev.deviceId+' selected >'+dev.label+'</option>');\r\n                    }\r\n\r\n                    if(currentSetSpeakerDeviceId == \"\" || currentSetSpeakerDeviceId != dev.deviceId){\r\n                        $('#speakerDev').append('<option value='+dev.deviceId+'>'+dev.label+'</option>')\r\n                        $('#outputDev').append('<option value='+dev.deviceId+'>'+dev.label+'</option>')\r\n                    }\r\n                    else if(currentSetSpeakerDeviceId == dev.deviceId){\r\n                        $('#speakerDev').append('<option value='+dev.deviceId+' selected >'+dev.label+'</option>')\r\n                        $('#outputDev').append('<option value='+dev.deviceId+' selected >'+dev.label+'</option>')\r\n                    }\r\n                }\r\n            });\r\n        })\r\n        .catch(function(error){\r\n            console.error(error);\r\n        })\r\n}\r\n\r\nfunction clearStars(){\r\n    var stars = document.querySelectorAll('.star');\r\n    for (i = 0; i < stars.length; i++) {\r\n        $(stars[i]).removeClass('selected');\r\n    }\r\n    _forEach.call(document.querySelectorAll('[name=\"callqualitycheck\"]'), e=>{\r\n        e.checked? (e.checked=false): null;\r\n    });\r\n    sendFeedbackComment.value=\"\";\r\n}\r\n\r\nfunction checkBrowserComplaince(client){\r\n    if(client.browserDetails.browser != \"chrome\"){\r\n        document.querySelectorAll('[href=\"#popAudioDevices\"]').forEach(el => el.remove());\r\n    }\r\n}\r\n\r\nfunction trimSpace(e){\r\n    e.value = e.value.replace(/[- ()]/g,'');\r\n}\r\n\r\nfunction callerIdAPI(username, id, type){\r\n    $.get( \"https://pxml.herokuapp.com/updateCallerId\", {username:username, callerId:id, type:type}, function(e) {\r\n        console.log( \"success\",e);\r\n    })\r\n        .done(function(e) {\r\n            console.log( \"done\",e );\r\n        })\r\n        .fail(function(e) {\r\n            console.log(\"fail\",e);\r\n        })\r\n}\r\n\r\nfunction saveCallerId(id){\r\n    if(!id){\r\n        console.warn('callerId you set is: '+id);\r\n        customAlert('callerId','empty','warn');\r\n        return;\r\n    }\r\n    localStorage.setItem('callerId',id);\r\n    console.log('callerId saved as :',localStorage.getItem('callerId'));\r\n    if (plivoBrowserSdk.client.userName) {\r\n        callerIdAPI(plivoBrowserSdk.client.userName, id, \"add\");\r\n    }\r\n    customAlert('callerId','saved: '+id,'info');\r\n}\r\n\r\nfunction removeCallerId(){\r\n    if (localStorage.hasOwnProperty('callerId')) {\r\n        localStorage.removeItem('callerId');\r\n        let id = document.getElementById('callerid');\r\n        console.debug('callerId removed');\r\n        if (plivoBrowserSdk.client.userName) {\r\n            callerIdAPI(plivoBrowserSdk.client.userName, id.value, \"remove\");\r\n        }\r\n        id.value = \"\";\r\n        customAlert('callerId','removed','info');\r\n    } else {\r\n        customAlert('callerId','not present','warn');\r\n    }\r\n}\r\n\r\nfunction setIti(instance) {\r\n    iti = instance;\r\n}\r\n\r\nfunction resetMute(){\r\n    tmute.setAttribute('data-toggle','mute');\r\n    $('.tmute').attr('class', 'fa tmute fa-microphone fa-lg callinfoIcon');\r\n}\r\n\r\nfunction volume(audioStats){\r\n    inputVolume = audioStats.inputVolume;\r\n    outputVolume =  audioStats.outputVolume;\r\n    colorPids(Math.floor(inputVolume * 325), 'localaudio');\r\n    colorPids(Math.floor(outputVolume * 325), 'remoteaudio');\r\n}\r\n\r\nfunction analyseAudio(volumeType) {\r\n    navigator.mediaDevices.getUserMedia({ audio: true, video: false })\r\n        .then(function(stream) {\r\n            let audioContext = new AudioContext();\r\n            let analyser = audioContext.createAnalyser();\r\n            let microphone = audioContext.createMediaStreamSource(stream);\r\n            let javascriptNode = audioContext.createScriptProcessor(2048, 1, 1);\r\n\r\n            analyser.smoothingTimeConstant = 0.8;\r\n            analyser.fftSize = 1024;\r\n\r\n            microphone.connect(analyser);\r\n            analyser.connect(javascriptNode);\r\n            javascriptNode.connect(audioContext.destination);\r\n            javascriptNode.onaudioprocess = function() {\r\n                let array = new Uint8Array(analyser.frequencyBinCount);\r\n                analyser.getByteFrequencyData(array);\r\n                let values = 0;\r\n\r\n                let length = array.length;\r\n                for (let i = 0; i < length; i++) {\r\n                    values += (array[i]);\r\n                }\r\n                let average = values / length;\r\n                colorPids(average, volumeType);\r\n            }\r\n        })\r\n        .catch(function(err) {\r\n            console.log(\"Unable to get user media\");\r\n        });\r\n}\r\n\r\nfunction colorPids(vol, volumeType) {\r\n    let all_pids = $('.pid'+volumeType);\r\n    let amout_of_pids = Math.round(vol/10);\r\n    let elem_range = all_pids.slice(0, amout_of_pids);\r\n    for (let i = 0; i < all_pids.length; i++) {\r\n        all_pids[i].style.backgroundColor=\"#e6e7e8\";\r\n    }\r\n    for (let j = 0; j < elem_range.length; j++) {\r\n        elem_range[j].style.backgroundColor=\"#69ce2b\";\r\n    }\r\n}\r\n\r\n\r\nfunction refreshAudioDevices() {\r\n    _forEach.call(document.querySelectorAll('#popAudioDevices option'), e=>e.remove());\r\n    plivoBrowserSdk.client.audio.revealAudioDevices()\r\n        .then(function(e){\r\n            updateAudioDevices();\r\n            console.log('Media permission ',e)\r\n        })\r\n        .catch(function(error){\r\n            console.error('media permission error :',error);\r\n            $('#mediaAccessBlock').modal('show');\r\n        })\r\n}\r\n\r\nfunction showOuputAudioLevel(volumeType) {\r\n    let audioContext = new AudioContext();\r\n    if (volumeType=='speakeroutput') {\r\n        speakerSourceNode = audioContext.createBufferSource();\r\n    } else {\r\n        ringtoneSourceNode = audioContext.createBufferSource();\r\n    }\r\n    let request = new XMLHttpRequest();\r\n    request.open('GET', 'media/us-ring.mp3', true);\r\n    request.responseType = 'arraybuffer';\r\n    // When loaded, decode the data and play the sound\r\n    request.onload = function () {\r\n        audioContext.decodeAudioData(request.response, function (buffer) {\r\n            if (volumeType=='speakeroutput') {\r\n                speakerSourceNode.buffer = buffer;\r\n                speakerSourceNode.start(0);\r\n                speakerSourceNode.loop = true;\r\n            } else {\r\n                ringtoneSourceNode.buffer = buffer;\r\n                ringtoneSourceNode.start(0);\r\n                ringtoneSourceNode.loop = true;\r\n            }\r\n        });\r\n    }\r\n    request.send();\r\n\r\n    // Analyse audio\r\n    let analyser = audioContext.createAnalyser();\r\n    let javascriptNode = audioContext.createScriptProcessor(2048, 1, 1);\r\n    analyser.smoothingTimeConstant = 0.8;\r\n    analyser.fftSize = 64;\r\n    if (volumeType=='speakeroutput') {\r\n        speakerSourceNode.connect(audioContext.destination);\r\n        speakerSourceNode.connect(analyser);\r\n    } else {\r\n        ringtoneSourceNode.connect(audioContext.destination);\r\n        ringtoneSourceNode.connect(analyser);\r\n    }\r\n    analyser.connect(javascriptNode);\r\n    javascriptNode.connect(audioContext.destination);\r\n    javascriptNode.onaudioprocess = function() {\r\n        let array = new Uint8Array(analyser.frequencyBinCount);\r\n        analyser.getByteFrequencyData(array);\r\n        let values = 0;\r\n        let length = array.length;\r\n        for (let i = 0; i < length; i++) {\r\n            values += (array[i]);\r\n        }\r\n        let average = values / (length/2);\r\n        if (average!=0) {\r\n            colorPids(average, volumeType);\r\n        }\r\n    }\r\n}\r\n\r\nfunction stopOutputAudioLevel(volumeType) {\r\n    if(volumeType=='speakeroutput') {\r\n        speakerSourceNode.stop(0);\r\n    }\r\n    if(volumeType=='ringoutput') {\r\n        ringtoneSourceNode.stop(0);\r\n    }\r\n}\r\n\r\nfunction hideKeypadInfo() {\r\n    $('.iti').hide();\r\n    $('#toNumber').hide();\r\n    $('.calleridinfo').hide();\r\n    $('#makecall').hide();\r\n    $('.micsettingslink').hide();\r\n}\r\n\r\nfunction showKeypadInfo() {\r\n    var phone = document.getElementById('phone');\r\n    phone.style.removeProperty(\"width\");\r\n    phone.style.removeProperty(\"margin-left\");\r\n    document.getElementById('loginkeypad').appendChild(phone);\r\n    $('#phone').show();\r\n    $('.callinfo').hide();\r\n    $('.iti').show();\r\n    $('#toNumber').show();\r\n    $('.calleridinfo').show();\r\n    $('#makecall').show();\r\n    $('.micsettingslink').show();\r\n    document.getElementById('showKeypad').value = 'showKeypad';\r\n    $('#showKeypad').html('SHOW KEYPAD');\r\n}\r\n\r\n\r\n/*\r\n\tCapture UI onclick triggers\r\n*/\r\n\r\n\r\n$('.hangup').click(function(){\r\n    console.info('Hangup');\r\n    if(plivoBrowserSdk.client.callSession){\r\n        plivoBrowserSdk.client.hangup();\r\n        showKeypadInfo();\r\n    }else{\r\n        callOff();\r\n    }\r\n});\r\n\r\n$('.answerIncoming').click(function(){\r\n    isIncomingCallPresent = false;\r\n    console.info('Call accept clicked');\r\n    if (incomingCallInfo) {\r\n        plivoBrowserSdk.client.answer(incomingCallInfo.callUUID);\r\n    } else {\r\n        plivoBrowserSdk.client.answer();\r\n    }\r\n    $('.incomingCallDefault').hide();\r\n    $('.callinfo').show();\r\n});\r\n\r\n$('.rejectIncoming').click(function(){\r\n    isIncomingCallPresent = false;\r\n    console.info('Call rejected');\r\n    if (incomingCallInfo) {\r\n        plivoBrowserSdk.client.reject(incomingCallInfo.callUUID);\r\n    } else {\r\n        plivoBrowserSdk.client.reject();\r\n    }\r\n    $('.incomingCallDefault').hide();\r\n});\r\n\r\n$('.ignoreIncoming').click(function(){\r\n    isIncomingCallPresent = false;\r\n    console.info('Call ignored');\r\n    if (incomingCallInfo) {\r\n        plivoBrowserSdk.client.ignore(incomingCallInfo.callUUID);\r\n    } else {\r\n        plivoBrowserSdk.client.ignore();\r\n    }\r\n    $('.incomingCallDefault').hide();\r\n});\r\n\r\n$('#tmute').click(function(e){\r\n    var event = e.currentTarget.getAttribute('data-toggle');\r\n    if(event == \"mute\"){\r\n        plivoBrowserSdk.client.mute();\r\n        e.currentTarget.setAttribute('data-toggle','unmute');\r\n        $('.tmute').attr('class', 'fa tmute fa-microphone-slash fa-lg callinfoIcon')\r\n    }else{\r\n        plivoBrowserSdk.client.unmute();\r\n        e.currentTarget.setAttribute('data-toggle','mute');\r\n        $('.tmute').attr('class', 'fa tmute fa-microphone fa-lg callinfoIcon')\r\n    }\r\n});\r\n\r\n$('#makecall').click(function(e){\r\n    var to = iti.getNumber(),\r\n        extraHeaders={},\r\n        customCallerId= localStorage.getItem('callerId');\r\n    if(customCallerId){\r\n        customCallerId = customCallerId.replace(\"+\",\"\");\r\n        extraHeaders = {'X-PH-callerId': customCallerId};\r\n    }\r\n    extraHeaders[\"X-PH-conference\"] = \"true\";\r\n    var callEnabled = $('#makecall').attr('class').match('disabled');\r\n    if(!to || !plivoBrowserSdk || !!callEnabled){return};\r\n    if(!plivoBrowserSdk.client.isLoggedIn){alert('You\\'re not Logged in!')}\r\n    plivoBrowserSdk.client.call(to,extraHeaders);\r\n    console.info('Click make call : ',to);\r\n    callStorage.mode = \"out\";\r\n    callStorage.startTime = date();\r\n    callStorage.num = to;\r\n    $('.phone').hide();\r\n    $('.AfterAnswer').show();\r\n    $('#boundType').html('Outgoing : '+to);\r\n    $('#callDuration').html('00:00:00');\r\n    $('.callinfo').show();\r\n});\r\n\r\n$('#updateSettings').click(function(e){\r\n    updateSettings(defaultSettings);\r\n\r\n});\r\n\r\n$('#resetSettings').click(function(e){\r\n    resetSettings();\r\n});\r\n\r\n$('#saveCallerId').click(function(e){\r\n    let callerid = document.getElementById('callerid').value;\r\n    saveCallerId(callerid);\r\n});\r\n\r\n$('#removeCallerId').click(function(e){\r\n    removeCallerId();\r\n});\r\n\r\n$('#clickClearAlerts').click(function(e){\r\n    $('.alertmsg').html('');\r\n});\r\n\r\n$('#sendFeedback').click(function(){\r\n    var score = $('#stars li.selected').last().data('value');\r\n    score = Number(score);\r\n    var lastCallid = plivoBrowserSdk.client.getLastCallUUID();\r\n    var issues=[];\r\n    _forEach.call(document.querySelectorAll('[name=\"callqualitycheck\"]'), e=>{\r\n        if(e.checked){\r\n            issues.push(e.value);\r\n        }\r\n    });\r\n    var note = sendFeedbackComment.value;\r\n    var sendConsoleLogs = document.getElementById(\"sendConsoleLogs\").checked;\r\n\r\n    // submitCallQualityFeedback takes parameteres callUUId, starRating, issues, note, sendConsoleLogs\r\n    plivoBrowserSdk.client.submitCallQualityFeedback(lastCallid, score, issues, note, sendConsoleLogs)\r\n        .then((result) => {\r\n            $('#feedbackStatus').html('Feedback sent');\r\n            $('#ignoreFeedback').click();\r\n            customAlert('Feedback sent','','info');\r\n            $('.lowQualityRadios').hide();\r\n        })\r\n        .catch((error) => {\r\n            $('#feedbackStatus').html(error);\r\n            customAlert('Could not send feedback','','warn');\r\n        });\r\n});\r\n\r\n// Reset the feedback dialog when ignore clicked\r\n$( \"#ignoreFeedback\" ).click(function() {\r\n    $('#stars li').removeClass(\"selected\");\r\n    $('#sendFeedbackComment').empty();\r\n    $('.lowQualityRadios input').prop('checked', false);\r\n    $(\"#feedbackStatus\").empty();\r\n    $('.lowQualityRadios').hide();\r\n});\r\n\r\n// Reset the feedback dialog when modal closed\r\n$('#sendQualityFeedback').on('hidden.bs.modal', function () {\r\n    $('#stars li').removeClass(\"selected\");\r\n    $('#sendFeedbackComment').empty();\r\n    $('.lowQualityRadios input').prop('checked', false);\r\n    $(\"#feedbackStatus\").empty();\r\n    $('.lowQualityRadios').hide();\r\n});\r\n\r\n$('.logout').click(function(e) {\r\n    //start UI load spinner\r\n    kickStartNow();\r\n    plivoBrowserSdk.client && plivoBrowserSdk.client.logout();\r\n\r\n});\r\n\r\n$('#clickLogin').click(function(e){\r\n    var userName = $('#loginUser').val();\r\n    var password = $('#loginPwd').val();\r\n    login(userName, password);\r\n});\r\n\r\n\r\n\r\n// Audio device selection\r\n$('#micDev').change(function(){\r\n    var selectDev = $('#micDev').val();\r\n    plivoBrowserSdk.client.audio.microphoneDevices.set(selectDev);\r\n    console.debug('Microphone device set to : ',selectDev);\r\n});\r\n\r\n$('#speakerDev').change(function(){\r\n    var selectDev = $('#speakerDev').val();\r\n    plivoBrowserSdk.client.audio.speakerDevices.set(selectDev);\r\n    console.debug('Speaker device set to : ',selectDev);\r\n});\r\n\r\n$('#ringtoneDev').change(function(){\r\n    var selectDev = $('#ringtoneDev').val();\r\n    plivoBrowserSdk.client.audio.ringtoneDevices.set(selectDev);\r\n    console.debug('Ringtone dev set to : ',selectDev);\r\n});\r\n\r\n$('#inputDev').change(function(){\r\n    var selectDev = $('#inputDev').val();\r\n    plivoBrowserSdk.client.audio.microphoneDevices.set(selectDev);\r\n    console.debug('Microphone device set to : ',selectDev);\r\n});\r\n$('#outputDev').change(function(){\r\n    var selectDev = $('#outputDev').val();\r\n    plivoBrowserSdk.client.audio.speakerDevices.set(selectDev);\r\n    console.debug('Speaker device set to : ',selectDev);\r\n});\r\n\r\n// Ringtone device test\r\n$('#ringtoneDevTest').click(function(){\r\n    let ringtoneVal = document.getElementById('ringtoneDevTest').innerText;\r\n    // Toggle Test\r\n    if(ringtoneVal=='Test') {\r\n        showOuputAudioLevel('ringoutput');\r\n        $('#ringtoneDevTest').html('Stop');\r\n    } else if(ringtoneVal=='Stop') {\r\n        stopOutputAudioLevel('ringoutput');\r\n        $('#ringtoneDevTest').html('Test');\r\n    }\r\n});\r\n\r\n// Speaker device test\r\n$('#speakerDevTest').click(function(){\r\n    let speakerVal = document.getElementById('speakerDevTest').innerText;\r\n    // Toggle Test\r\n    if(speakerVal=='Test') {\r\n        showOuputAudioLevel('speakeroutput');\r\n        $('#speakerDevTest').html('Stop');\r\n    } else if(speakerVal=='Stop') {\r\n        stopOutputAudioLevel('speakeroutput');\r\n        $('#speakerDevTest').html('Test');\r\n    }\r\n});\r\n\r\n//revealAudioDevices\r\n$('#allowAudioDevices').click(function(){\r\n    refreshAudioDevices();\r\n});\r\n\r\n$('.micsettingslink').click(function(){\r\n    refreshAudioDevices();\r\n    analyseAudio('input');\r\n});\r\n\r\n$('#miclink').click(function(){\r\n    refreshAudioDevices();\r\n});\r\n\r\n$('#showKeypad').click(function(){\r\n    let keypadVal = document.getElementById('showKeypad').value;\r\n    if (keypadVal=='showKeypad') {\r\n        var phone = document.getElementById('phone');\r\n        document.getElementById('callanswerpad').appendChild(phone);\r\n        phone.style.width=\"80%\";\r\n        phone.style.marginLeft=\"13%\";\r\n        $('#phone').show();\r\n        hideKeypadInfo();\r\n        document.getElementById('showKeypad').value = 'hideKeypad';\r\n        $('#showKeypad').html('HIDE KEYPAD');\r\n    }\r\n    else if (keypadVal=='hideKeypad') {\r\n        $('#phone').hide();\r\n        document.getElementById('showKeypad').value = 'showKeypad';\r\n        $('#showKeypad').html('SHOW KEYPAD');\r\n    }\r\n});\r\n\r\n$('.num').click(function () {\r\n    var num = $(this);\r\n    var text = $.trim(num.find('.txt').clone().children().remove().end().text());\r\n    var telNumber = $('#toNumber');\r\n    $(telNumber).val(telNumber.val() + text);\r\n    if(plivoBrowserSdk && plivoBrowserSdk.client.callSession){\r\n        plivoBrowserSdk.client.sendDtmf(text);\r\n    }\r\n});\r\n\r\nfunction starFeedback(){\r\n    $('#stars li').on('mouseover', function(){\r\n        var onStar = parseInt($(this).data('value'), 10); // The star currently mouse on\r\n        // Now highlight all the stars after the current hovered star\r\n        $(this).parent().children('li.star').each(function(e){\r\n            if (e < onStar) {\r\n                $(this).addClass('hover');\r\n            }\r\n            else {\r\n                $(this).removeClass('hover');\r\n            }\r\n        });\r\n    }).on('mouseout', function(){\r\n        $(this).parent().children('li.star').each(function(e){\r\n            $(this).removeClass('hover');\r\n        });\r\n    });\r\n\r\n    //Action to perform on click */\r\n    $('#stars li').on('click', function(){\r\n        var onStar = parseInt($(this).data('value'), 10); // The star currently selected\r\n        var stars = $(this).parent().children('li.star');\r\n        for (i = 0; i < stars.length; i++) {\r\n            $(stars[i]).removeClass('selected');\r\n        }\r\n        for (i = 0; i < onStar; i++) {\r\n            $(stars[i]).addClass('selected');\r\n        }\r\n        var value = parseInt($('#stars li.selected').last().data('value'), 10);\r\n        if(value < 5){\r\n            $('.lowQualityRadios').show();\r\n        }else{\r\n            $('.lowQualityRadios').hide();\r\n        }\r\n    });\r\n}\r\n\r\n\r\n// variables to declare\r\n\r\nvar plivoBrowserSdk; // this will be retrived from settings in UI\r\n\r\nfunction initPhone(username, password){\r\n    var options = refreshSettings();\r\n    plivoBrowserSdk = new window.Plivo(options);\r\n\r\n    plivoBrowserSdk.client.on('onWebrtcNotSupported', onWebrtcNotSupported);\r\n    plivoBrowserSdk.client.on('onLogin', onLogin);\r\n    plivoBrowserSdk.client.on('onLogout', onLogout);\r\n    plivoBrowserSdk.client.on('onLoginFailed', onLoginFailed);\r\n    plivoBrowserSdk.client.on('onCallRemoteRinging', onCallRemoteRinging);\r\n    plivoBrowserSdk.client.on('onIncomingCallCanceled', onIncomingCallCanceled);\r\n    plivoBrowserSdk.client.on('onIncomingCallIgnored', onIncomingCallCanceled);\r\n    plivoBrowserSdk.client.on('onCallFailed', onCallFailed);\r\n    plivoBrowserSdk.client.on('onMediaConnected', onMediaConnected);\r\n    plivoBrowserSdk.client.on('onCallAnswered', onCallAnswered);\r\n    plivoBrowserSdk.client.on('onCallTerminated', onCallTerminated);\r\n    plivoBrowserSdk.client.on('onCalling', onCalling);\r\n    plivoBrowserSdk.client.on('onIncomingCall', onIncomingCall);\r\n    plivoBrowserSdk.client.on('onMediaPermission', onMediaPermission);\r\n    plivoBrowserSdk.client.on('mediaMetrics',mediaMetrics);\r\n    plivoBrowserSdk.client.on('audioDeviceChange',audioDeviceChange);\r\n    plivoBrowserSdk.client.on('onPermissionDenied', onPermissionDenied);\r\n    plivoBrowserSdk.client.on('onConnectionChange', onConnectionChange); // To show connection change events\r\n    plivoBrowserSdk.client.on('volume', volume);\r\n    //onSessionExpired\r\n\r\n    // Methods\r\n    plivoBrowserSdk.client.setRingTone(true);\r\n    plivoBrowserSdk.client.setRingToneBack(false);\r\n    plivoBrowserSdk.client.setConnectTone(true); // Dial beep will play till we get alert response from network.\r\n    plivoBrowserSdk.client.setDebug(\"ALL\"); // Allowed values are OFF, ERROR, WARN, INFO, DEBUG, ALL\r\n\r\n    /** Handle browser issues\r\n     * Sound devices won't work in firefox\r\n     */\r\n    checkBrowserComplaince(plivoBrowserSdk.client);\r\n    starFeedback();\r\n    console.log('initPhone ready!')\r\n}\r\n"]}]}